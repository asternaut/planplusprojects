var _lovIdFieldID;
var _lovDnFieldID;
var _lovFormName;
var _LovIdDnFieldID;
var _LovCnFieldID;
var _lovCompanyPopupVersion = 1;

function openLOVCompanyPopup( formname, idfield, dnfield )
{
    _lovCompanyPopupVersion = 1;
    _lovFormName  = formname;
    _lovIdFieldID = idfield;
    _lovDnFieldID = dnfield;
    var popupURL = "ozSlsLOVCompany.jsp?lovsrc=GEN_CF&searchParam="+document.forms[formname].elements[dnfield].value;
    var lovWin = window.open(popupURL, 'LOVCompany', 'left=100,top=60,width=700,height=540,scrollbars=yes');
    lovWin.opener = self;
    lovWin.focus();
}
function acceptLOVCompanyPopup( id, dn )
{
  if ( _lovCompanyPopupVersion == 2 )
  {
    //quick create Org/Contacts Can�t changed  
    /*$( _lovIdFieldID ).value = id;
    $( _lovDnFieldID ).value = URLDecode(dn);*/
    document.getElementById( _lovIdFieldID ).value = id;
    document.getElementById( _lovDnFieldID ).value = URLDecode(dn);
  }
  else
  {
    document.forms[_lovFormName].elements[_lovIdFieldID].value = id;
    document.forms[_lovFormName].elements[_lovDnFieldID].value = URLDecode(dn);
  }
}
function openLOVCompanyPopupV2( idIdfield, idDnfield )
{
  _lovCompanyPopupVersion = 2;
  _lovIdFieldID = idIdfield;
  _lovDnFieldID = idDnfield;
  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view
  //var popupURL = "ozSlsLOVCompany.jsp?lovsrc=GEN_CF&searchParam="+$(idDnfield).value;
  var popupURL = "ozSlsLOVCompany.jsp?lovsrc=GEN_CF&searchParam="+document.getElementById(idDnfield).value;
  var lovWin = window.open(popupURL, 'LOVCompany', 'left=100,top=60,width=700,height=540,scrollbars=yes');
  lovWin.opener = self;
  lovWin.focus();
}

function thickboxOpenUrl( tbcaption, tburl )
{
  tb_show( tbcaption, tburl);
//  tb_remove();
}
function openLOVPersonPopup( formname, idfield, dnfield )
{
    _lovCompanyPopupVersion = 1;
    _lovFormName  = formname;
    _lovIdFieldID = idfield;
    _lovDnFieldID = dnfield
    var popupURL = "ozSlsLOVContact.jsp?lovsrc=GEN_CF&searchParam="+document.forms[formname].elements[dnfield].value;
    var lovWin = window.open(popupURL, 'LOVContact', 'left=100,top=60,width=700,height=540,scrollbars=yes');
    lovWin.opener = self;
    lovWin.focus();
}
function acceptLOVPersonPopup( id, dn, fn, ln, email, phone )
{
  if ( _lovCompanyPopupVersion == 2 )
  {
    //quick create Org/Contacts Can�t changed
    /*$( _lovIdFieldID ).value = id;
    $( _lovDnFieldID ).value = URLDecode(dn);*/
    document.getElementById( _lovIdFieldID ).value = id;
    document.getElementById( _lovDnFieldID ).value = URLDecode(dn);
  }
  else
  {
    document.forms[_lovFormName].elements[_lovIdFieldID].value = id;
    document.forms[_lovFormName].elements[_lovDnFieldID].value = URLDecode(dn);
  }
}
function openLOVContactPopupV2( idIdfield, idDnfield )
{
  _lovCompanyPopupVersion = 2;
  _lovIdFieldID = idIdfield;
  _lovDnFieldID = idDnfield;
  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view  
  //var popupURL = "ozSlsLOVContact.jsp?lovsrc=GEN_CF&searchParam="+$(idDnfield).value;
  var popupURL = "ozSlsLOVContact.jsp?lovsrc=GEN_CF&searchParam="+document.getElementById(idDnfield).value;
  var lovWin = window.open(popupURL, 'LOVContact', 'left=100,top=60,width=700,height=540,scrollbars=yes');
  lovWin.opener = self;
  lovWin.focus();
}
//Project Task : 13908  Oppty Quick Create show contacts of the Org
function openLOVContactPopupV3( idIdfield,idDnfieldId, idDnfield,idCnfield )
{
  _lovCompanyPopupVersion = 2;
  _lovIdFieldID = idIdfield;
  _lovDnFieldID = idDnfield;
  _LovIdDnFieldID = idDnfieldId;
  _LovCnFieldID = idCnfield;
  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view
  //var popupURL = "ozSlsLOVContact.jsp?lovsrc=GEN_CF&custID="+$(idDnfieldId).value + "&searchParam="+$(idDnfield).value;
  var popupURL = "ozSlsLOVContact.jsp?lovsrc=GEN_CF&custID="+document.getElementById(idDnfieldId).value + "&searchParam="+document.getElementById(idDnfield).value;
  var lovWin = window.open(popupURL, 'LOVContact', 'left=100,top=60,width=700,height=540,scrollbars=yes');
  lovWin.opener = self;
  lovWin.focus();
}

var _lovIdPrdcatId;
var _lovIdPrdId;
var _lovidDisp;
var _lovidPrice;
var _lovidQty;
var _lovidAmt;
function openLOVProductPopupV2( idPrdcatId, idPrdId, idDisp, idPrice, idQty, idAmt )
{
  _lovIdPrdcatId = idPrdcatId;
  _lovIdPrdId    = idPrdId;
  _lovidDisp     = idDisp;
  _lovidPrice    = idPrice;
  _lovidQty      = idQty;
  _lovidAmt      = idAmt;
  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view  
  //var lovURL = 'ozLOVProductV2.jsp?id='+$(idPrdcatId).value;
  var lovURL = 'ozLOVProductV2.jsp?id='+document.getElementById(idPrdcatId).value;
  var lovWin = window.open( lovURL, 'LOVProduct', 'left=100,top=60,width=700,height=500,scrollbars=yes');
  lovWin.opener = self;
  lovWin.focus();
}

function acceptLOVProductV2( cid, pid, dn, itemName, itemDesc, taxable, price, cost )
{
  //quick create Org/Contacts and product Can�t changed  
  /*$( _lovIdPrdcatId ).value = cid;
  $( _lovIdPrdId ).value = pid;
  $( _lovidDisp ).value = URLDecode(dn);

  if ( _lovidPrice != '' ) $( _lovidPrice ).value = price;*/
  document.getElementById( _lovIdPrdcatId ).value = cid;
  document.getElementById( _lovIdPrdId ).value = pid;
  document.getElementById( _lovidDisp ).value = URLDecode(dn);

  if ( _lovidPrice != '' ) document.getElementById( _lovidPrice ).value = price;
  if ( _lovidQty != '' )
  {
    var qty = 1.0 * document.getElementById(_lovidQty).value;
    if ( qty == 1.0 || qty == 0.0 )
    {
      //quick create Org/Contacts Can�t changed  
      /*$(_lovidQty).value = '1';
      $(_lovidAmt).value = price;*/
      document.getElementById(_lovidQty).value = '1';
      document.getElementById(_lovidAmt).value = price;
    }
    else
    {
      //quick create Org/Contacts and product Can�t changed
      //$(_lovidAmt).value = qty * price;;
      document.getElementById(_lovidAmt).value = qty * price;;
    }
  }
}

function calculateAmountV2( idQty, idAmt, idPrice )
{
    //quick create Org/Contacts Can�t changed
    /*var qty = 1.0 * $(idQty).value;
    $(idAmt).value = limit2dec ( qty * $(idPrice).value );*/
    var qty = 1.0 * document.getElementById(idQty).value;
    document.getElementById(idAmt).value = limit2dec ( qty * document.getElementById(idPrice).value );
}



function openLOVUserPopup( formname, idfield, dnfield )
{
  _lovFormName  = formname;
  _lovIdFieldID = idfield;
  _lovDnFieldID = dnfield
  var popupURL = "ozLOVUser.jsp?lovsrc=GEN_CF";
  var lovWin = window.open(popupURL, 'LOVUser', 'left=100,top=60,width=700,height=540,scrollbars=yes');
  lovWin.opener = self;
  lovWin.focus();
}
function acceptLOVUserPopup( id, dn, fn, ln, email, phone )
{
  document.forms[_lovFormName].elements[_lovIdFieldID].value = id;
  document.forms[_lovFormName].elements[_lovDnFieldID].value = URLDecode(dn);
}


// the following function is for the Search & View definition, Date field
function openLOVDatePopup2( formname, qualfield, valfield )
{
  _lovFormName  = formname;
  _lovIdFieldID = valfield;

  // qualfield is a select
  var qualValue = document.forms[formname].elements[qualfield].options[ document.forms[formname].elements[qualfield].selectedIndex ].value;
  var popupURL = "ozLOVDateRange.jsp?lovsrc=GEN_CF&mode=";
  if ( qualValue == 'BETWEEN' || qualValue == 'BTW' ) popupURL = popupURL + '2';
  else                          popupURL = popupURL + '1';
  popupURL = popupURL + '&val=' + document.forms[formname].elements[valfield].value;
  var lovWin = window.open(popupURL, 'LOVDateRange', 'left=100,top=60,width=800,height=560,scrollbars=yes');
  lovWin.opener = self;
  lovWin.focus();
}
function acceptLOVDatePopup2( val1, val2 )
{
  if ( val2 == '' )
    document.forms[_lovFormName].elements[_lovIdFieldID].value = val1;
  else
    document.forms[_lovFormName].elements[_lovIdFieldID].value = val1 + ',' + val2;
}


var __popupContent = '';
function blockAllAndPopup( popupContent )
{
  blockAllAndPopupOnResize();
  window.onresize = blockAllAndPopupOnResize;

  //quick create Org/Contacts Can�t changed
  //$('ajax_inline_popup_div').innerHTML = $('ajax_inline_popup_div_backup').value + ' <BR> &nbsp; <img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';
  document.getElementById('ajax_inline_popup_div').innerHTML = document.getElementById('ajax_inline_popup_div_backup').value + ' <BR><img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';
  __popupContent = popupContent;
  postXmlHttp( 'xhpLOVDispatcher.jsp'+genappend_submiturl+'&pc='+popupContent, 'blockAllAndPopupRefresh()' );
}
function blockAllAndPopupPsnNew( popupContent, custid )
{
  blockAllAndPopupOnResize();
  window.onresize = blockAllAndPopupOnResize;

  //quick create Org/Contacts Can�t changed
  //$('ajax_inline_popup_div').innerHTML = $('ajax_inline_popup_div_backup').value + ' <BR> &nbsp; <img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';
  document.getElementById('ajax_inline_popup_div').innerHTML = document.getElementById('ajax_inline_popup_div_backup').value + ' <BR> &nbsp; <img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';
  __popupContent = popupContent;  // 'PSN_NEW'
  postXmlHttp( 'xhpLOVDispatcher.jsp'+genappend_submiturl+'&pc='+popupContent+'&custid='+custid, 'blockAllAndPopupRefresh()' );
}
function blockAllAndPopupOppNew( popupContent, custid, cnctid, productId )
{
  //PPOL-1947 Resize opportunity create page
  //blockAllAndPopupOnResize();
  // window.onresize = blockAllAndPopupOnResize;
  blockAllAndPopupOnResize1();
  window.onresize = blockAllAndPopupOnResize1;

  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view  
  /*$('ajax_inline_popup_div').innerHTML = $('ajax_inline_popup_div_backup').value + ' <BR> &nbsp; <img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';*/
  document.getElementById('ajax_inline_popup_div').innerHTML = document.getElementById('ajax_inline_popup_div_backup').value + ' <BR> &nbsp; <img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';

  __popupContent = popupContent;  // 'OPP_NEW'
  postXmlHttp( 'xhpLOVDispatcher.jsp'+genappend_submiturl+'&pc='+popupContent+'&custid='+custid+'&cnctid='+cnctid+'&productId='+productId, 'blockAllAndPopupRefresh()' );
}
function blockAllAndPopupOppNew2( custid, cnctid, productId )
{
  blockAllAndPopupOnResize();
  window.onresize = blockAllAndPopupOnResize;

  //quick create Org/Contacts Can�t changed
  //$('ajax_inline_popup_div').innerHTML = $('ajax_inline_popup_div_backup').value + ' <BR> &nbsp; <img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';
  document.getElementById('ajax_inline_popup_div').innerHTML = document.getElementById('ajax_inline_popup_div_backup').value + ' <BR> &nbsp; <img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';

  __popupContent = 'OPP_NEW';
  postXmlHttp( 'xhpLOVDispatcher.jsp'+genappend_submiturl+'&pc=OPP_NEW&custid='+custid+'&cnctid='+cnctid+'&productId='+productId, 'blockAllAndPopupRefresh()' );
}

// Project Task : 1911325 attach projects with Opportunities
function blockAllAndPopupPrjNew( popupContent,prjId,oppId )
{
  blockAllAndPopupOnResize();
  window.onresize = blockAllAndPopupOnResize;

  //quick create Org/Contacts Can�t changed
  //$('ajax_inline_popup_div').innerHTML = $('ajax_inline_popup_div_backup').value + ' <BR> &nbsp; <img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';
  document.getElementById('ajax_inline_popup_div').innerHTML = document.getElementById('ajax_inline_popup_div_backup').value + ' <BR> &nbsp; <img id="waitgif" src="graphics/wait2.gif" align=absmiddle width=20 height=20>';

  __popupContent = popupContent;  // 'PRJ_NEW'
  postXmlHttp( 'xhpLOVDispatcher.jsp'+genappend_submiturl+'&pc='+popupContent+'&prjId='+prjId+'&oppId='+oppId , 'blockAllAndPopupRefresh()' );
}


function blockAllAndPopupRefresh()
{
  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view  
  //$('ajax_inline_popup_div').innerHTML = _xmlHttpRequestObj.responseText;
  document.getElementById('ajax_inline_popup_div').innerHTML = _xmlHttpRequestObj.responseText; 
  // Project Task : 1911325 attach projects with Opportunities
  //if ( __popupContent == 'ORG_NEW' || __popupContent == 'PSN_NEW')
  if ( __popupContent == 'ORG_NEW' || __popupContent == 'PSN_NEW' || __popupContent == 'PRJ_NEW')
  {
    try {
      autocomplete('inlinePopupCreateForm_zip', 'zip-autocomplete-popup', 'xhpZipCode.jsp'+genappend_submiturl, 'strInput', null, 'inlinePopupCreateForm' );
    } catch ( Exception ) {}
  }
  if ( __popupContent == 'OPP_NEW' )
  {
    try {
      autocomplete('ajaxnewopp_prodName_0', '_product-autocomplete-popup_0', 'xhpAutoCompleteProduct.jsp'+genappend_submiturl, 'strInput', null, 'inlinePopupCreateFormOpp' );
      autocomplete('ajaxnewopp_prodName_1', '_product-autocomplete-popup_1', 'xhpAutoCompleteProduct.jsp'+genappend_submiturl, 'strInput', null, 'inlinePopupCreateFormOpp' );
      autocomplete('ajaxnewopp_prodName_2', '_product-autocomplete-popup_2', 'xhpAutoCompleteProduct.jsp'+genappend_submiturl, 'strInput', null, 'inlinePopupCreateFormOpp' );
      autocomplete('ajaxnewopp_prodName_3', '_product-autocomplete-popup_3', 'xhpAutoCompleteProduct.jsp'+genappend_submiturl, 'strInput', null, 'inlinePopupCreateFormOpp' );
      autocomplete('ajaxnewopp_prodName_4', '_product-autocomplete-popup_4', 'xhpAutoCompleteProduct.jsp'+genappend_submiturl, 'strInput', null, 'inlinePopupCreateFormOpp' );
    } catch ( Exception ) { }

  }
}

function blockAllAndPopupOnResize() {
  var blockAll = document.getElementById( 'ajax_blockall_div' );

  document.getElementsByTagName('body')[0].style.overflow = 'hidden';

  blockAll.style.top   = "0px";
  blockAll.style.left  = "0px";

  blockAll.style.width  = window.innerWidth;
  blockAll.style.height  = window.innerHeight;

  blockAll.position = "fixed";
  blockAll.style.visibility = 'visible';
  blockAll.style.display = "block";
  adjustiFrame( blockAll );
  
  var popup = document.getElementById( 'ajax_inline_popup_div' );
  var wW = window.innerWidth;

  var popupWidth = 700;
  var popupHeight = 500;
  
  var popupLeft = parseInt((wW - popupWidth) / 2, 10);

  popup.style.top   = 60;
  popup.style.left  = popupLeft;
  
  popup.style.width  = popupWidth;
  popup.style.height = popupHeight;
  
  popup.style.background = "FFFFFF";
  popup.style.backgroundColor = "FFFFFF";

  popup.position = "relative";

  popup.style.visibility = 'visible';
  popup.style.display = "block";

  adjustiFrame( popup );

}

function blockAllAndPopupCancel()
{
  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view  
  //var blockAll = $( 'ajax_blockall_div' );
  var blockAll = document.getElementById( 'ajax_blockall_div' );
  
  blockAll.style.top   = "0px";
  blockAll.style.left  = "0px";
  blockAll.style.width  = 1;
  blockAll.style.height = 1;
  blockAll.style.zIndex = 1;
  blockAll.style.visibility = 'hidden';
  blockAll.style.display = "none";
  adjustiFrame( blockAll );

  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view  
  //var popup = $( 'ajax_inline_popup_div' );
  var popup = document.getElementById( 'ajax_inline_popup_div' );
  popup.style.top   = "0px";
  popup.style.left  = "0px";
  popup.style.width  = 1;
  popup.style.height = 1;
  popup.style.zIndex = 1;
  popup.style.visibility = 'hidden';
  popup.style.display = "none";
  document.getElementsByTagName('body')[0].style.overflow = 'visible';
  adjustiFrame( popup );
}

function getPageSizeWithScroll()
{
  if (window.innerHeight && window.scrollMaxY) {// Firefox

		yWithScroll = window.innerHeight + window.scrollMaxY;
		xWithScroll = window.innerWidth + window.scrollMaxX;
  } else if (document.body.scrollHeight > document.body.offsetHeight){ // all but Explorer Mac
		yWithScroll = document.body.scrollHeight;
		xWithScroll = document.body.scrollWidth;
  } else { // works in Explorer 6 Strict, Mozilla (not FF) and Safari
		yWithScroll = document.body.offsetHeight+ document.body.offsetTop;
		xWithScroll = document.body.offsetWidth+ document.body.offsetLeft;
  }
  	
  arrayPageSizeWithScroll = new Array(xWithScroll,yWithScroll);
  return arrayPageSizeWithScroll;
}


function ajax_gen_ui_helper_hidediv()
{
  var gen_ui_helper_div = document.getElementById('gen_ui_helper_div');
  gen_ui_helper_div.style.visibility = 'hidden';
  gen_ui_helper_div.style.display = "none";
  adjustiFrame( gen_ui_helper_div );
}

function ajaxneworg_proceed_save()
{
  currMouseX = window.event.clientX+document.body.scrollLeft;
  currMouseY = window.event.clientY+document.body.scrollTop;

  //quick create Org/Contacts Can�t changed  
  //var ajax_neworg_submiturl = 'xhpCustomerNew.jsp'+genappend_submiturl + '&custName=' + escape( $('ajaxneworg_custName').value );
    //PPOL-1226 Home Page-Quick Create-Create Contact/Organization:Validation required on Empty Values..
    //var ajax_neworg_submiturl = 'xhpCustomerNew.jsp'+genappend_submiturl + '&custName=' + escape( document.getElementById('ajaxneworg_custName').value );
    var ajax_neworg_submiturl = 'xhpCustomerNew.jsp'+genappend_submiturl + '&custName=' + escape( document.getElementsByName('custName').value );

  if(  document.getElementsByName('custName')[0].value != "")
  postXmlHttp( ajax_neworg_submiturl, 'ajaxneworg_ajax_neworg_followup()' );
}
function ajaxneworg_ajax_neworg_followup()
{
  var retStr = LTrim( _xmlHttpRequestObj.responseText ); 
    
  if ( retStr.substring(0,7) == 'SUCCESS' )
  {
    new iiframe(document.ajaxneworg);
  }
  else
  {
    var gen_ui_helper_div = document.getElementById('gen_ui_helper_div');
    if ( gen_ui_helper_div != null )
    {
      gen_ui_helper_div.innerHTML = retStr; 
      gen_ui_helper_div.style.visibility = 'visible';
      gen_ui_helper_div.style.display = "block";
      gen_ui_helper_div.style.top   = (currMouseY - 100) + "px";
      gen_ui_helper_div.style.left  = (currMouseX - 20) + "px";
      gen_ui_helper_div.style.width = "330px";
      adjustiFrame( gen_ui_helper_div );
    }
  }
}

function ajaxnewpsn_proceed_save()
{
  currMouseX = window.event.clientX+document.body.scrollLeft;
  currMouseY = window.event.clientY+document.body.scrollTop;

  //quick create Org/Contacts Can�t changed  
  /*var ajax_newpsn_submiturl = 'xhpContactNew.jsp'+genappend_submiturl + '&contactFN=' + escape( $('ajaxnewpsn_firstName').value )
              + '&contactLN=' + escape( $('ajaxnewpsn_lastName').value ) + '&ajaxform=Y';*/
  /*var ajax_newpsn_submiturl = 'xhpContactNew.jsp'+genappend_submiturl + '&contactFN=' + escape( document.getElementById('ajaxnewpsn_firstName').value )
              + '&contactLN=' + escape( document.getElementById('ajaxnewpsn_lastName').value ) + '&ajaxform=Y';
  postXmlHttp( ajax_newpsn_submiturl, 'ajaxnewpsn_ajax_newpsn_followup()' );*/
    var ajax_newpsn_submiturl = 'xhpContactNew.jsp'+genappend_submiturl + '&contactFN=' + escape( document.getElementsByName('firstName').value )
              + '&contactLN=' + escape( document.getElementsByName('lastName').value ) + '&ajaxform=Y';
    if( document.getElementsByName('firstName')[0].value!= "" && document.getElementsByName('lastName')[0].value!= "" )
    postXmlHttp( ajax_newpsn_submiturl, 'ajaxnewpsn_ajax_newpsn_followup()' );

}
function ajaxnewpsn_ajax_newpsn_followup()
{
  var retStr = LTrim( _xmlHttpRequestObj.responseText ); 
    
  if ( retStr.substring(0,7) == 'SUCCESS' )
  {
    new iiframe(document.ajaxnewpsn);
  }
  else
  {
    var gen_ui_helper_div = document.getElementById('gen_ui_helper_div');
    if ( gen_ui_helper_div != null )
    {
      gen_ui_helper_div.innerHTML = retStr; 
      gen_ui_helper_div.style.visibility = 'visible';
      gen_ui_helper_div.style.display = "block";
      gen_ui_helper_div.style.top   = (currMouseY - 100) + "px";
      gen_ui_helper_div.style.left  = (currMouseX - 20) + "px";
      gen_ui_helper_div.style.width = "330px";
      adjustiFrame( gen_ui_helper_div );
    }
  }
}
function ajaxnewpsn_proceed_save_confirm()
{
    new iiframe(document.ajaxnewpsn);
}

// Project Task : 1911325 attach projects with Opportunities
function ajaxnewprj_proceed_save(oppId)
{
  currMouseX = window.event.clientX+document.body.scrollLeft;
  currMouseY = window.event.clientY+document.body.scrollTop;

  //quick create Org/Contacts Can�t changed  
  /*var ajax_newprj_submiturl = 'xhpPrjNew.jsp'+genappend_submiturl + '&prjName=' + escape( $('ajaxnewprj_prjName').value )
                              + '&customerId=' + $('ajaxnewprj_customerId').value  + '&contactId=' + $('ajaxnewprj_contactId').value +'&ajaxform=Y'+'&oppId='+oppId+'&inlinePopupCreate=Y' + '&prjStatus='+$('ajaxnewprj_prjStatus').value + '&prjType=' + $('ajaxnewprj_prjType').value +'&ajaxnewprj_eValue='+$('ajaxnewprj_eValue').value+
          '&ajaxnewprj_prjPriority='+$('ajaxnewprj_prjPriority').value+'&owner='+$('owner').value+'&startingdate='+$('startingdate').value+'&endDate='+$('endDate').value+'&ts_submit_hour='+$('ts_submit_hour').value+'&ts_submit_min='+$('ts_submit_min').value+'&ts_submit_sec='+$('ts_submit_sec').value + '&ajaxnewprj_visState='+$('ajaxnewprj_visState').value;*/

  /*PPOL-1423   Case 90264343 - Can't add a project template from quick create in Opportunites*/
  /*var ajax_newprj_submiturl = 'xhpPrjNew.jsp'+genappend_submiturl + '&prjName=' + escape( document.getElementById('ajaxnewprj_prjName').value )
                              + '&customerId=' + document.getElementById('ajaxnewprj_customerId').value  + '&contactId=' + document.getElementById('ajaxnewprj_contactId').value +'&ajaxform=Y'+'&oppId='+oppId+'&inlinePopupCreate=Y' +  '&prjStatus='+document.getElementById('ajaxnewprj_prjStatus').value + '&prjType=' + document.getElementById('ajaxnewprj_prjType').value +'&ajaxnewprj_eValue='+document.getElementById('ajaxnewprj_eValue').value+
          '&ajaxnewprj_prjPriority='+document.getElementById('ajaxnewprj_prjPriority').value+'&owner='+document.getElementById('owner').value+'&startingdate='+document.getElementById('startingdate').value+'&endDate='+document.getElementById('endDate').value+'&ts_submit_hour='+document.getElementById('ts_submit_hour').value+'&ts_submit_min='+document.getElementById('ts_submit_min').value+'&ts_submit_sec='+document.getElementById('ts_submit_sec').value + '&ajaxnewprj_visState='+document.getElementById('ajaxnewprj_visState').value;*/

  var ajax_newprj_submiturl = 'xhpPrjNew.jsp'+genappend_submiturl + '&prjName=' + escape( document.getElementById('ajaxnewprj_prjName').value )
      + '&customerId=' + document.getElementById('ajaxnewprj_customerId').value  + '&contactId=' + document.getElementById('ajaxnewprj_contactId').value +'&ajaxform=Y'+'&oppId='+oppId+'&inlinePopupCreate=Y' + '&tmpl='+document.getElementById('ajaxnewprj_prjTemplate').value+ '&prjStatus='+document.getElementById('ajaxnewprj_prjStatus').value + '&prjType=' + document.getElementById('ajaxnewprj_prjType').value +'&ajaxnewprj_eValue='+document.getElementById('ajaxnewprj_eValue').value+
      '&ajaxnewprj_prjPriority='+document.getElementById('ajaxnewprj_prjPriority').value+'&owner='+document.getElementById('owner').value+'&startingdate='+document.getElementById('startingdate').value+'&endDate='+document.getElementById('endDate').value+'&ts_submit_hour='+document.getElementById('ts_submit_hour').value+'&ts_submit_min='+document.getElementById('ts_submit_min').value+'&ts_submit_sec='+document.getElementById('ts_submit_sec').value + '&ajaxnewprj_visState='+document.getElementById('ajaxnewprj_visState').value;


  postXmlHttp( ajax_newprj_submiturl, 'ajaxnewprj_ajax_newprj_followup()' );
}
function ajaxnewprj_ajax_newprj_followup()
{
  var retStr = LTrim( _xmlHttpRequestObj.responseText );

  if ( retStr.substring(0,7) == 'SUCCESS' )
  {
    //new iiframe(document.ajaxnewprj);
      alert("Project Created Successfully");
      blockAllAndPopupCancel();
      baseScreenReload();
  }
  else
  {
    var gen_ui_helper_div = document.getElementById('gen_ui_helper_div');
    if ( gen_ui_helper_div != null )
    {
      gen_ui_helper_div.innerHTML = retStr;
      gen_ui_helper_div.style.visibility = 'visible';
      gen_ui_helper_div.style.display = "block";
      gen_ui_helper_div.style.top   = (currMouseY - 100) + "px";
      gen_ui_helper_div.style.left  = (currMouseX - 20) + "px";
      gen_ui_helper_div.style.width = "330px";
      adjustiFrame( gen_ui_helper_div );
    }
  }
}
function ajaxnewprj_proceed_save_confirm()
{
    new iiframe(document.ajaxnewprj);
}


function ajaxnewopp_proceed_save()
{
  currMouseX = window.event.clientX+document.body.scrollLeft;
  currMouseY = window.event.clientY+document.body.scrollTop;

  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view  
  /*var ajax_newopp_submiturl = 'xhpOppNew.jsp'+genappend_submiturl + '&oppName=' + escape( $('ajaxnewopp_oppName').value )
            + '&customerId=' + $('ajaxnewopp_customerId').value  + '&contactId=' + $('ajaxnewopp_contactId').value;*/
  

  // PPOL-411: Quick Create Oppty Not Working
  var urlCustomerId = (document.getElementById('ajaxnewopp_customerId')) ? document.getElementById('ajaxnewopp_customerId').value : '';
  var urlOppStage = (document.getElementById('ajaxnewopp_oppStage')) ? document.getElementById('ajaxnewopp_oppStage').value : '';
  var urlOppName = (document.getElementById('ajaxnewopp_oppName')) ? escape(document.getElementById('ajaxnewopp_oppName').value) : '';
  var urlContactId = (document.getElementById('ajaxnewopp_contactId')) ? document.getElementById('ajaxnewopp_contactId').value : '';
  var urlCustomerName = (document.getElementById('ajaxnewopp_customerName')) ? escape(document.getElementById('ajaxnewopp_customerName').value) : '';
  var urlProcessId = (document.getElementById('processId')) ? document.getElementById('processId').value : '';
  var urlOppChannel = (document.getElementById('oppChannel')) ? document.getElementById('oppChannel').value : '';
  var urlWinProb = (document.getElementById('ajaxnewopp_winProb')) ? document.getElementById('ajaxnewopp_winProb').value : '';
  var urlOwnerId = (document.getElementById('ownerId')) ? document.getElementById('ownerId').value : '';
  var urlOppDesc = (document.getElementById('oppDesc')) ? document.getElementById('oppDesc').value : '';
  var urlOppStatus = (document.getElementById('ajaxnewopp_oppStatus')) ? document.getElementById('ajaxnewopp_oppStatus').value : '';
  var urlOppCurrency = (document.getElementById('oppCurrency')) ? document.getElementById('oppCurrency').value : '';

  var ajax_newopp_submiturl = 'xhpOppNew.jsp'+genappend_submiturl + '&oppName='+urlOppName          // PPOL-352 Error in Opp Creation
          + '&customerId='+urlCustomerId+'&contactId='+urlContactId
          + '&customerName='+urlCustomerName+'&processId='+urlProcessId
          + '&oppChannel='+urlOppChannel+'&oppStatus='+urlOppStatus+ '&oppCurrency='+urlOppCurrency+'&winProb='+urlWinProb
          +'&ownerId='+urlOwnerId+ '&oppStage='+urlOppStage+'&oppDesc='+urlOppDesc+'&submitcreate=Y';
  postXmlHttp( ajax_newopp_submiturl, 'ajaxnewopp_ajax_newopp_followup()' );
}
function ajaxnewopp_ajax_newopp_followup()
{
  var retStr = LTrim( _xmlHttpRequestObj.responseText ); 
    
  if ( retStr.substring(0,7) == 'SUCCESS' )
  {
    new iiframe(document.ajaxnewopp);
  }
  else
  {
    var gen_ui_helper_div = document.getElementById('gen_ui_helper_div');
    if ( gen_ui_helper_div != null )
    {
      gen_ui_helper_div.innerHTML = retStr; 
      gen_ui_helper_div.style.visibility = 'visible';
      gen_ui_helper_div.style.display = "block";
      gen_ui_helper_div.style.top   = (currMouseY - 100) + "px";
      gen_ui_helper_div.style.left  = (currMouseX - 20) + "px";
      gen_ui_helper_div.style.width = "330px";
      adjustiFrame( gen_ui_helper_div );
    }
  }
}
function ajaxnewopp_change_stage()
{
  //Quick create button doesn�t seem to be launching for Opportunities when under the Organization view  
  //var ajax_newopp_submiturl = 'xhpOppNew.jsp'+genappend_submiturl + '&act=CHANGE_STAGE&stage=' + escape( $('ajaxnewopp_oppStage').value );
  var ajax_newopp_submiturl = 'xhpOppNew.jsp'+genappend_submiturl + '&act=CHANGE_STAGE&stage=' + escape( document.getElementById('ajaxnewopp_oppStage').value );
  postXmlHttp( ajax_newopp_submiturl, 'ajaxnewopp_ajax_change_stage_followup()' );
}
function ajaxnewopp_ajax_change_stage_followup()
{
  var retStr = LTrim( _xmlHttpRequestObj.responseText ); 
  eval( retStr );
}

function blockAllAndPopupOrgNewHandler( xmlHttpRequestObj )
{
//  if( xmlHttpRequestObj.readyState == 'complete' )
  {
    var retStr = LTrim( xmlHttpRequestObj.responseText ); 
    if ( retStr.substring(0,7) == 'SUCCESS' )
    {
      if ( ajax_eb_appcode == 'PPOL' || ajax_eb_appcode == 'PPOLB' )
      {
      }
      else
      {
        alert( retStr );
      }
      blockAllAndPopupCancel();
      baseScreenReload();
        
    }
    else
    {
      var gen_ui_helper_div = document.getElementById('gen_ui_helper_div');
      if ( gen_ui_helper_div != null )
      {
        gen_ui_helper_div.innerHTML = retStr; 
        gen_ui_helper_div.style.visibility = 'visible';
        gen_ui_helper_div.style.display = "block";
        gen_ui_helper_div.style.top   = (currMouseY - 100) + "px";
        gen_ui_helper_div.style.left  = (currMouseX - 20) + "px";
        gen_ui_helper_div.style.width = "330px";
        adjustiFrame( gen_ui_helper_div );
      }
    }
  }
}
//PPOL-1226 Home Page-Quick Create-Create Contact/Organization:Validation required on Empty Values..
function orgFunction() {
     var cName = document.getElementsByName("custName")[0].value;
      if(cName== null  || cName == "" || cName.length <=0 )
      alert("Please Enter Customer Name");
    }
//PPOL-1226 Home Page-Quick Create-Create Contact/Organization:Validation required on Empty Values..
function conFunction() {
     //var prcName = document.getElementById("processN").value;
    var fName = document.getElementsByName("firstName")[0].value;
     var lName = document.getElementsByName("lastName")[0].value;
   
      if( fName == ""|| fName == undefined)
      {
      alert("Please Enter First Name");
      return;
      }
      if(lName == "" || lName == undefined )
      {
        alert("Please Enter Last Name");
        return false;
      }
       return false;
    
    }
  // PPOL-1360  Redesign UI Implementation of Adding References  3:49 PM 8/23/2016
function acceptLOVCompanyPopupNew( id, dn,formname, idfield,refId,reftype,refVal){

  _lovFormName = formname;
  _lovIdFieldID = idfield;

  if ( _lovCompanyPopupVersion == 2 )
  {
    //quick create Org/Contacts Can�t changed
    /*$( _lovIdFieldID ).value = id;
     $( _lovDnFieldID ).value = URLDecode(dn);*/
    document.getElementById( _lovIdFieldID ).value = id;
    document.getElementById( _lovDnFieldID ).value = URLDecode(dn);
  }
  else
  {
    console.log("id="+id);
    console.log("dn="+dn);
    document.forms[_lovFormName].elements[_lovIdFieldID].value = dn;
    document.forms[_lovFormName].elements[refId].value = id;
    document.forms[_lovFormName].elements[reftype].value=refVal;
    

  }
  
}// PPOL-1360 

//PPOL-1947 Resize opportunity create page
function blockAllAndPopupOnResize1() {
  var blockAll = document.getElementById( 'ajax_blockall_div' );

  document.getElementsByTagName('body')[0].style.overflow = 'hidden';

  blockAll.style.top   = "0px";
  blockAll.style.left  = "0px";

  blockAll.style.width  = window.innerWidth;
  blockAll.style.height  = window.innerHeight;

  blockAll.position = "fixed";
  blockAll.style.visibility = 'visible';
  blockAll.style.display = "block";
  adjustiFrame( blockAll );

  var popup = document.getElementById( 'ajax_inline_popup_div' );
  var wW = window.innerWidth;

  var popupWidth = 900;
  var popupHeight = 500;

  var popupLeft = parseInt((wW - popupWidth) / 2, 10);

  popup.style.top   = 60;
  popup.style.left  = popupLeft;

  popup.style.width  = popupWidth;
  popup.style.height = popupHeight;

  popup.style.background = "FFFFFF";
  popup.style.backgroundColor = "FFFFFF";

  popup.position = "relative";

  popup.style.visibility = 'visible';
  popup.style.display = "block";

  adjustiFrame( popup );

}
