
var __gTmp = '';
var __baseScreenReloadSpecialBranch = 0;

function emulateEventHandlers(eventNames) {
   for (var i = 0; i < eventNames.length; i++) {        
      document.addEventListener(eventNames[i], function (e) {
         window.event = e;
      }, true); // using capture
   }
}

ua = navigator.userAgent;
if ( ua.indexOf("Netscape") > 0 || ua.indexOf("Gecko") > 0 )
{
   emulateEventHandlers(["click", "mousemove", "mouseover"]);
}


function URLEncode( plaintext )
{
  // The Javascript escape and unescape functions do not correspond
  // with what browsers actually do...
  var SAFECHARS = "0123456789" +                                  // Numeric
                                        "ABCDEFGHIJKLMNOPQRSTUVWXYZ" +  // Alphabetic
                                        "abcdefghijklmnopqrstuvwxyz" +
                                        "-_.!~*'()";                                    // RFC2396 Mark characters
  var HEX = "0123456789ABCDEF";
  var encoded = "";
  for (var i = 0; i < plaintext.length; i++ )
  {
    var ch = plaintext.charAt(i);
    if (ch == " ") {
                    encoded += "+";                             // x-www-urlencoded, rather than %20
    } else if (SAFECHARS.indexOf(ch) != -1) {
                    encoded += ch;
    } else {
                    var charCode = ch.charCodeAt(0);
                        if (charCode > 255) {
                            alert( "Unicode Character '" + ch + "' cannot be encoded using standard URL encoding.\n" +
                                        "(URL encoding only supports 8-bit characters.)\n" +
                                                "A space (+) will be substituted." );
                                encoded += "+";
                        } else {
                                encoded += "%";
                                encoded += HEX.charAt((charCode >> 4) & 0xF);
                                encoded += HEX.charAt(charCode & 0xF);
                        }
    }
  } // for

  return encoded;
};

function URLDecode( encoded )
{
   // Replace %xx with equivalent character
   var plaintext = "";
   var i = 0;
   while (i < (encoded.length-2))
   {
     var ch = encoded.charAt(i);
     if (ch == "+") {
               plaintext += " ";
                   i++;
     }
     else if (ch == "%" && encoded.charAt(i+1) != "%") {
       plaintext += unescape( encoded.substr(i,3) );
       i += 3;
     }
     else if (ch == "&" && encoded.charAt(i+1) == "#" && encoded.charAt(i+2) == "3" && encoded.charAt(i+3) == "4" && encoded.charAt(i+4) == ";")
     {
       plaintext += unescape( "%22" );
       i += 5;
     }
     else if (ch == "&" && encoded.charAt(i+1) == "#" && encoded.charAt(i+2) == "3" && encoded.charAt(i+3) == "9" && encoded.charAt(i+4) == ";")
     {
       plaintext += unescape( "%27" );
       i += 5;
     }
     else if (ch == "&" && encoded.charAt(i+1) == "#" && encoded.charAt(i+2) == "6" && encoded.charAt(i+3) == "0" && encoded.charAt(i+4) == ";")
     {
       plaintext += unescape( "%3C" );
       i += 5;
     }
     else if (ch == "&" && encoded.charAt(i+1) == "#" && encoded.charAt(i+2) == "1" && encoded.charAt(i+3) == "0" && encoded.charAt(i+4) == ";")
     {
       plaintext += unescape( "%0A" );
       i += 5;
     }
     else if (ch == "&" && encoded.charAt(i+1) == "#" && encoded.charAt(i+2) == "1" && encoded.charAt(i+3) == "3" && encoded.charAt(i+4) == ";")
     {
       plaintext += unescape( "%0D" );
       i += 5;
     }
     else {
       plaintext += ch;
       i++;
     }
   } // while
   if (i < encoded.length) {
            plaintext += encoded.substr(i,encoded.length-i);
   }
   return unescape(plaintext);
};

function floor(number)
{
  return Math.floor(number*Math.pow(10,2))/Math.pow(10,2);
} 
    
function markDirty(frm, elm, val)
{
  document.forms[frm].elements[elm].value=val;
}

function MM_goToURL() { //v3.0
    var i, args=MM_goToURL.arguments; document.MM_returnValue = false;
    for (i=0; i<(args.length-1); i+=2) eval(args[i]+".location='"+args[i+1]+"'");
}

function MM_openBrWindow(theURL,winName,features) { //v2.0
  var popWin = window.open(theURL,winName,features);
  popWin.opener = self;
  popWin.focus();
}

function ozPopupTiny(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=100,top=60,width=400,height=300,scrollbars=yes,resizable=yes');
  popWin.opener = self;
  popWin.focus();
}

function ozPopupMid(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=100,top=60,width=500,height=400,scrollbars=yes,resizable=yes');
  popWin.opener = self;
  popWin.focus();
}

function ozPopup(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=100,top=60,width=760,height=540,scrollbars=yes,resizable=yes');
  popWin.opener = self;
  popWin.focus();
}

function ozPopupLarge(theURL) { //v2.0
  var popWin = window.open(theURL,'PopupWindowsLarge','width=996,height=720,resizable=yes,scrollbars=yes');
  popWin.opener = self;
  popWin.focus();
}
//PPOL-594
function ozPopup1(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=100,top=60,width=950,height=540,scrollbars=yes');
  popWin.opener = self;
  popWin.focus();
}
function OZ_openBrWindow(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=100,top=60,width=720,height=540,scrollbars=yes,resizable=yes');
  popWin.opener = self;
  popWin.focus();
}
function OZ_openBrWindowWide(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=100,top=60,width=880,height=540,scrollbars=yes,resizable=yes');
  popWin.opener = self;
  popWin.focus();
}

function OZ_openBrWin2(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=100,top=35,width=880,height=630,scrollbars=yes,resizable=yes');
  popWin.opener = self;
  popWin.focus();
}

function OZ_openBrWin2WMenu(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=100,top=60,width=900,height=720,scrollbars=yes,menubar=yes');
  popWin.opener = self;
  popWin.focus();
}

function OZ_openBrWin3(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=10,top=10,width=960,height=700,scrollbars=yes,menubar=yes');
  popWin.opener = self;
  popWin.focus();
}

function OZ_openBrWin4(theURL,winName) { //v2.0
  var popWin = window.open(theURL,winName,'left=100,top=60,width=880,height=560,resizable=yes');
  popWin.opener = self;
  popWin.focus();
}

function OZ_openBrWin5(theURL,winName) { // full screen
  var w = window.screen.availWidth;
  var h = window.screen.availHeight;
  var popWin = window.open(theURL,winName,' screenX=0,screenY=0,left=0,top=0,width='+w+',height='+h+',resizable=1,scrollbars=yes');
  popWin.opener = self;
  popWin.focus();
}

function OZ_openBrWinTop3(theURL,winName) { //Specific to Planner Top3 -Jamal 28-Oct-2010
  //var popWin = window.open(theURL,winName,'left=100,top=40,width=950,height=600,resizable=yes,scrollbars=yes');
  var popWin = window.open(theURL,winName,'left=200,top=40,width=700,height=580,resizable=0,scrollbars=0');  
  popWin.opener = self;
  popWin.focus();
}
function OZ_openBrWinAppt(theURL,winName) { //Specific to create new appointment from 'Calendar'
  var popWin = window.open(theURL,winName,'left=100,top=60,width=880,height=560,resizable=yes');
  popWin.opener = self;
  popWin.focus();
}

function openTimePopupV1( ot, oi )
{
  var popWin = window.open( 'ozCmnTimeSubmit.jsp?objType='+ot+'&objId='+oi,'LOVTimeV1'+oi,'width=880,height=680,scrollbars=yes,resizable=yes' );
  popWin.opener = self;
  popWin.focus();
}

function openExpensePopupV1( ot, oi )
{
  var popWin = window.open( 'ozLOVExpenseSubmit.jsp?objType='+ot+'&objId='+oi,'LOVExpenseV1'+oi,'width=880,height=680,scrollbars=yes,resizable=yes' );
  popWin.opener = self;
  popWin.focus();
}

function MM_jumpMenu(targ,selObj,restore)
{
  var selValue = selObj.options[selObj.selectedIndex].value;
  if ( selValue.startswith( "javascript", 0, 10 ) )
    eval( selValue.substring(11) );  // javascript:
  else
  {
    eval(targ+".location='"+selValue+"'");
    if (restore) selObj.selectedIndex=0;
  }
}

function MM_jumpMenu2(targ,selObj,restore)
{
  var s = selObj.options[selObj.selectedIndex].value;
  if ( s.substring(0,1) != '_' )
  {
    eval(targ+".location='"+selObj.options[selObj.selectedIndex].value+"'");
  }
  else
  {
    s = s.substring(1, s.length);
    eval( s );
  }
}

 // This method Added by siva for dropdown functionality in Calendar.

function MM_jumpMenu3(targ,selObj,uvalue,restore)
{
  var s = selObj.options[selObj.selectedIndex].value;
  var u = '';
  if ( uvalue == 'views')
     u = uvalue;
  else
     u = uvalue.options[uvalue.selectedIndex].value;
  if ( s.substring(0,1) != '_' && u.substring(0,1) != '_' )
  {
    eval(targ+".location='"+selObj.options[selObj.selectedIndex].value+"&userview="+u+"'");
  }
  else
  {
    s = s.substring(1, s.length);
    eval( s );
  }
}

function MM_setSelObj( selObj, tgtVal )
{
  for (i=0; i<selObj.options.length; i++)
  {
    if ( selObj.options[i].value == tgtVal )
      selObj.selectedIndex = i;
  }
}

function MM_getSelObjValue( selObjId )
{
  return $(selObjId).options[$(selObjId).selectedIndex].value;
}

function handleKeyPressReturnUnfocus( e, obj )
{
  var key=e.keyCode || e.which;
  if (key==13) { obj.blur(); return false; }
}
function handleKeyPressExecFunc( e, func, arg )
{
  var key=e.keyCode || e.which;
  if (key==13) { 
  	func(arg); 
  	return false; 
  	}
}

function openLovPopup(fileName, lovName, formName, elmtName)
{
  var paramVal = document.forms[formName].elements[elmtName].value;
  var param = "?paramValue=" + paramVal;

  var lovWin = window.open( fileName + param, lovName, 'width=720,height=500,scrollbars=yes');
    lovWin.opener = self;
    lovWin.focus();
}

function openLovPopupWParam(fileName, lovName, formName, elmtName)
{
  var paramVal = document.forms[formName].elements[elmtName].value;
  var param = "&paramValue=" + paramVal;

  var lovWin = window.open( fileName + param, lovName, 'width=720,height=500,scrollbars=yes');
    lovWin.opener = self;
    lovWin.focus();
}

var openCalV2FieldID;
var openCalV2FormID;
var _openCalV = 2;
function openCalV2( formname, fieldid )
{
  openCalV2FormID  = formname;
  openCalV2FieldID = fieldid;
  _openCalV = 2;
  opencal2( document.forms[openCalV2FormID].elements[openCalV2FieldID].value );
}
var _gOpenCalV4Str;
function acceptDateV2(dayStr)
{
  if ( _openCalV == 2 )
    document.forms[openCalV2FormID].elements[openCalV2FieldID].value = dayStr;

  else if ( _openCalV == 3 )
  {
      //$(openCalV3FieldID).value = dayStr;
   document.getElementById(openCalV3FieldID).value = dayStr;
  }
  else if ( _openCalV == '3WITHPOST' )
  {
    //$(openCalV3FieldID).value = dayStr;
    document.getElementById(openCalV3FieldID).value = dayStr;
    openCalV3Post();
  }
  else if ( _openCalV.startswith( "4", 0, 1 ) )
  {
      //$(openCalV3FieldID).value = dayStr;
   document.getElementById(openCalV3FieldID).value = dayStr;
    _gOpenCalV4Str = _openCalV.substring(1);
    setTimeout('gOpenCalV4Call()',10);
  }
}
function gOpenCalV4Call()
{
    eval( _gOpenCalV4Str );
}

var openCalV3FieldID;
function openCalV3( fieldid )
{
  openCalV3FieldID = fieldid;
  _openCalV = 3;
    var datepick=document.getElementById(fieldid).value;
    //opencal2( $(fieldid).value );
    opencal2( datepick );

}
function openCalV31( fieldid, aptName )
{
  openCalV3FieldID = fieldid;
  _openCalV = 3;
  opencal21( $(fieldid).value, aptName );
}
function openCalV3WithPost( fieldid )
{
  openCalV3FieldID = fieldid;
  _openCalV = '3WITHPOST';
  opencal2( $(fieldid).value );
}
function openCalV4( fieldid, advJS )
{
  openCalV3FieldID = fieldid;
  _openCalV = '4'+advJS;
  opencal2( $(fieldid).value );
}

function openCalV41( fieldid, advJS, aptName )
{
  openCalV3FieldID = fieldid;
  _openCalV = '4'+advJS;
  opencal21( $(fieldid).value, $(aptName).value );
}

function getBrowserSizeX() {
  var myWidth = 0;
  if( typeof( window.innerWidth ) == 'number' ) {
    //Non-IE
    myWidth = window.innerWidth;
  }
  else
  {
    if( document.documentElement &&
        ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
      //IE 6+ in 'standards compliant mode'
      myWidth = document.documentElement.clientWidth;
    }
    else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
        //IE 4 compatible
      myWidth = document.body.clientWidth;
    }
  }
  return myWidth;
}

function getBrowserSizeY() {
  var myHeight = 0;
  if( typeof( window.innerWidth ) == 'number' ) {
    //Non-IE
    myHeight = window.innerHeight;
  }
  else
  {
    if( document.documentElement &&
        ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
      //IE 6+ in 'standards compliant mode'
      myHeight = document.documentElement.clientHeight;
    } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
        //IE 4 compatible
      myHeight = document.body.clientHeight;
    }
  }
  return myHeight;
}

function Toggle(item) {
   //added by janet 2005.11.7 ---begin
   var max=item+"_max";
   var min=item+"_min";
   objMax=document.getElementById(max);
   objMin=document.getElementById(min);
   //added by janet 2005.11.7 ---end
   obj=document.getElementById(item);

   visible=(obj.style.display!="none")  
   if (visible) {
     obj.style.display="none";
     //added by janet 2005.11.7 ---begin
     if ( objMax != null ) objMax.style.display="block";
     if ( objMin != null ) objMin.style.display="none";
     //added by janet 2005.11.7 ---end
   } else {
     obj.style.display="block";
     //added by janet 2005.11.7 ---begin
     if ( objMax != null ) objMax.style.display="none";
     if ( objMin != null ) objMin.style.display="block";
     //added by janet 2005.11.7 ---end
   }
}
function ToggleSet(item,val) {
   obj=document.getElementById(item);
   obj.style.display=val;
}
function ToggleExt(item) {
   obj=document.getElementById(item);

   visible=(obj.style.display!="none")  
   if (visible) {
     obj.style.display="none";
   } else {
     obj.style.display="block";
     var el = Ext.get( item );
     el.fadeIn( { endOpacity: 1.0, easing: 'easeIn', duration: 0.5 } );
   }
}
function ToggleExt(item) {
   obj=document.getElementById(item);

   visible=(obj.style.display!="none")  
   if (visible) {
     obj.style.display="none";
   } else {
     obj.style.display="block";
     var el = Ext.get( item );
     el.fadeIn( { endOpacity: 1.0, easing: 'easeIn', duration: 0.5 } );
   }
}
function ToggleSetExt(item) {
   obj=document.getElementById(item);
   obj.style.display="block";
   var el = Ext.get( item );
   el.fadeIn( { endOpacity: 1.0, easing: 'easeIn', duration: 0.5 } );
}


var _gToggleSetSlideShowItemId;
var _gToggleSetSlideShowItemHeight;
function ToggleSetSlideShow(itemid)
{
  _gToggleSetSlideShowItemId = itemid;
  _gToggleSetSlideShowItemHeight = 1;
//  $(_gToggleSetSlideShowItemId).style.display='block';
    document.getElementById(_gToggleSetSlideShowItemId).style.display='block';
//  $(_gToggleSetSlideShowItemId).style.height ='1px';
     document.getElementById(_gToggleSetSlideShowItemId).style.height ='1px';
  var timer = window.setTimeout( 'ToggleSetSlideShowAction()', 20 );
}
function ToggleSetSlideShowAction()
{
  _gToggleSetSlideShowItemHeight = _gToggleSetSlideShowItemHeight + 2;
  if ( _gToggleSetSlideShowItemId.substring(0,7) == 'PKGMENU' )
  {
    if ( _gToggleSetSlideShowItemHeight <= 32 )
    {
      //$(_gToggleSetSlideShowItemId).style.height = _gToggleSetSlideShowItemHeight + "px";
      document.getElementById(_gToggleSetSlideShowItemId).style.height = _gToggleSetSlideShowItemHeight + "px";
      var timer = window.setTimeout( 'ToggleSetSlideShowAction()', 20 );
    }
  }
  else
  {
    if ( _gToggleSetSlideShowItemHeight <= 16 )
    {
      //$(_gToggleSetSlideShowItemId).style.height = _gToggleSetSlideShowItemHeight + "px";
      document.getElementById(_gToggleSetSlideShowItemId).style.height = _gToggleSetSlideShowItemHeight + "px";
      var timer = window.setTimeout( 'ToggleSetSlideShowAction()', 30 );
    }
  }
}

var IFrameObj; // our IFrame object
var _backgroundURL;
function jsCallToServer(backgroundURL)
{
  if (!document.createElement)
  {
    return true;
  }
  
  var IFrameDoc;
  _backgroundURL =  backgroundURL;
  if (!IFrameObj && document.createElement)
  {
    // create the IFrame and assign a reference to the object to our global variable IFrameObj.
    // this will only happen the first time callToServer() is called
    try
    {
               var tempIFrame=document.createElement('iframe');
               tempIFrame.setAttribute('id','RSIFrame');
               tempIFrame.src='z0.jsp';
               tempIFrame.style.border='0px';
               tempIFrame.style.width='0px';
               tempIFrame.style.height='0px';
               IFrameObj = document.body.appendChild(tempIFrame);
               
               if (document.frames)
               {// this is for IE5 Mac, because it will only allow access to the document object
               // of the IFrame if we access it through the document.frames array
                    IFrameObj = document.frames['RSIFrame'];
               }
    }
    catch(exception)
    {
        // This is for IE5 PC, which doesn't allow dynamic creation/manipulation of iframe object.
               // Instead, we'll fake it up by creating our own objects.
               iframeHTML='\<iframe id="RSIFrame" src="z0.jsp" style="';
               iframeHTML+='border:0px;';
               iframeHTML+='width:0px;';
               iframeHTML+='height:0px;';
               iframeHTML+='"><\/iframe>';
               document.body.innerHTML+=iframeHTML;
               IFrameObj = new Object();
               IFrameObj.document = new Object();
               IFrameObj.document.location = new Object();
               IFrameObj.document.location.iframe = document.getElementById('RSIFrame');
               IFrameObj.document.location.replace = function(location) {this.iframe.src = location;}
    }
  }          


  if (navigator.userAgent.indexOf('Gecko') !=-1 && !IFrameObj.contentDocument)
  {
    // we have to give NS6 a fraction of a second
    // to recognize the new IFrame
    setTimeout('jsCallToServer()',10);
    return false;
  }
 
  if (IFrameObj.contentDocument)
  {     // For NS6
          IFrameDoc = IFrameObj.contentDocument;
  }
  else if (IFrameObj.contentWindow)
  {     // For IE5.5 and IE6
          IFrameDoc = IFrameObj.contentWindow.document;
  }
  else if (IFrameObj.document)
  {     // For IE5
           IFrameDoc = IFrameObj.document;
  }
  else
  {
          return true;
  }
 
  IFrameDoc.location.replace(_backgroundURL);
  return false;
}

function ToggleAndSubmit(item, divid) {
   obj=document.getElementById(item);
   visible=(obj.style.display!="none")  
   if (visible)
   {
     obj.style.display="none";
     backgroundURL = 'ozCmnHideShow.jsp?id='+divid+'&action=none';
   }
   else
   {
     obj.style.display="block";
     backgroundURL = 'ozCmnHideShow.jsp?id='+divid+'&action=block';
   }
   
   jsCallToServer( backgroundURL );
}

function submitQuickAmountNonInventory( oppId )
{
    var oppQuickAmountNonInventory = document.getElementById( 'oppQuickAmountNonInventory' ).value;
    if( oppQuickAmountNonInventory <= 0.0 )
      alert ( 'You have to put in a positive numeric value.' );
    else {

        /*PPOL-1932 Refresh page loses inputs when you add amount value*/
        //document.location = 'ozSlsOppPln.jsp?id=' + oppId + '&ac=submitQuickAmountNonInventory&quickAmountNonInventory=' + oppQuickAmountNonInventory;
        SimpleAJAXCall ( 'ozSlsOppPln.jsp'+genappend_submiturl+'&id='+oppId+'&ac=submitQuickAmountNonInventory&quickAmountNonInventory='+oppQuickAmountNonInventory, gen_oppAmountAdv, 'POST', '' );
    }
}

function limit2dec(val)
{
    if (val == 0) return ("0");
    if (val == "") return ("");
    var inputVal = ("" + val);
    if (inputVal.indexOf(".") == -1) inputVal+=".000000";
    else                             inputVal+="000000";
    var decPart = inputVal.substring(0,inputVal.indexOf("."));
    var fracPart = inputVal.substring(inputVal.indexOf(".")+1,inputVal.indexOf(".")+3);
    var dec3Part=parseInt(inputVal.substring(inputVal.indexOf(".")+3,inputVal.indexOf(".")+4));
    if ((dec3Part >= 5))
    {
      if(parseFloat(fracPart)== 99)
      {
        fracPart = "00";
        if(parseFloat(decPart)>=0) decPart  =  ""+ (parseFloat(decPart) + 1);
        else decPart  =  ""+ (parseFloat(decPart) - 1);
      }
      else
      {
        var tmp = parseFloat( fracPart ) + 1;
        if ( tmp < 10 )        fracPart = "0"+tmp;
        else                   fracPart = ""+tmp;
      }
    }
    return ("" + decPart + "." + fracPart);
}


function gen_sidebar_adjust_timeline()
{
  if ( $('gen_ui_helper_div') != null )
  {
    for ( i=0; i< $('gen_ui_helper_div').childNodes.length; i++ )
    {
      try {
        var currentElementChild=$('gen_ui_helper_div').childNodes[i];
        var tmpDivId = currentElementChild.getAttribute("nodeid");
        if ( tmpDivId!=null && tmpDivId.length > 8 && ( tmpDivId.substring(0,8)=='TSK_HST_' || tmpDivId.substring(0,8)=='BUG_HST_' ) )
        {
          gen_sidebar_adjust_timeline_position( currentElementChild );
        }
      }
      catch(ee) { }
    }
  }
}
function gen_cmp_adjust_timeline_position()
{
  if ( $('gen_ui_helper_div') != null )
  {
    for ( i=0; i< $('gen_ui_helper_div').childNodes.length; i++ )
    {
      try {
        var currentElementChild=$('gen_ui_helper_div').childNodes[i];
        var tmpDivId = currentElementChild.getAttribute("nodeid");
        if ( tmpDivId!=null && tmpDivId.length > 8 && tmpDivId.substring(0,8)=='CSH_HST_' )
        {
          gen_sidebar_adjust_timeline_position( currentElementChild );
        }
      }
      catch(ee) { }
    }
  }
}
function gen_sidebar_adjust_timeline_position( node )
{
  var posX = getAbsElementXById( 'TIMELINE_MAINLINE' );
  var posY = getAbsElementYById( 'TIMELINE_MAINLINE' );

  var offsetx = node.getAttribute("offsetx");
  node.style.position = "absolute";
  node.style.top  = "40px";
  node.style.left = (parseInt(offsetx)+6)  + "px";
}
function gen_sidebar_adjust_timeline_viewdtl( id, nodetype, nodeid )
{
  SimpleAJAXCall ( 'xhpCaseSideDtl.jsp'+genappend_submiturl+'&id='+id+'&sbtype=TIMELINEDTL&nodetype='+nodetype+'&nodeid='+nodeid, gen_sidebar_adjust_timeline_viewdtl_refresh, 'POST', '' );
}
function gen_sidebar_adjust_timeline_viewbugdtl( id, nodetype, nodeid )
{
  SimpleAJAXCall ( 'xhpBugSideDtl.jsp'+genappend_submiturl+'&id='+id+'&sbtype=TIMELINEDTL&nodetype='+nodetype+'&nodeid='+nodeid, gen_sidebar_adjust_timeline_viewdtl_refresh, 'POST', '' );
}
function gen_sidebar_adjust_timeline_vieworgdtl( id, nodetype, nodeid )
{
  SimpleAJAXCall ( 'xhpOrgSideDtl.jsp'+genappend_submiturl+'&id='+id+'&sbtype=TIMELINEDTL&nodetype='+nodetype+'&nodeid='+nodeid, gen_sidebar_adjust_timeline_viewdtl_refresh, 'POST', '' );
}
function gen_sidebar_adjust_timeline_viewpsndtl( id, nodetype, nodeid )
{
  SimpleAJAXCall ( 'xhpPsnSideDtl.jsp'+genappend_submiturl+'&id='+id+'&sbtype=TIMELINEDTL&nodetype='+nodetype+'&nodeid='+nodeid, gen_sidebar_adjust_timeline_viewdtl_refresh, 'POST', '' );
}
function gen_sidebar_adjust_timeline_viewoppdtl( id, nodetype, nodeid )
{
  SimpleAJAXCall ( 'xhpOppSideDtl.jsp'+genappend_submiturl+'&id='+id+'&sbtype=TIMELINEDTL&nodetype='+nodetype+'&nodeid='+nodeid, gen_sidebar_adjust_timeline_viewdtl_refresh, 'POST', '' );
}
function gen_sidebar_adjust_timeline_viewcshdtl( csid )
{
  SimpleAJAXCall ( 'xhpCmpGetData.jsp'+genappend_submiturl+'&csid='+csid+'&act=TIMELINEDTL', gen_sidebar_adjust_timeline_viewdtl_refresh, 'POST', '' );
}
function gen_sidebar_adjust_timeline_viewdtl_refresh( in_responseText, in_param )
{
  $('divTimelineDtl').innerHTML = in_responseText; 
}
function gen_oppAmountAdv( in_responseText, in_param )
{
    document.getElementById('oppAmountAdv').innerHTML = in_responseText;
    document.getElementById('ajax_contextmenu_div').style.visibility ='hidden';
}




function insertAtCursor(myField, myValue)
{
  //IE support
  if (browser.isIE)
  {
    myField.focus();
    var sel = document.selection.createRange();
    sel.text = myValue;
    var dummy=myField.createTextRange();
    dummy.findText( myValue );
    dummy.select();
  }
  //MOZILLA/NETSCAPE support
  else if ( browser.isNS )
  {
    myField.focus();
    var startPos = myField.selectionStart;
    var oldLength = myField.value.length;
    if ( oldLength > 0 )
      myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring( startPos, oldLength );
    else
      myField.value = myValue;
    myField.setSelectionRange(startPos, startPos + myValue.length );
  }
  else {
    myField.value += myValue;
  }
}

function insertAtCursor2(myField, myValue)
{
  //IE support
  if (browser.isIE)
  {
    myField.focus();
    var sel = document.selection.createRange();
    sel.text = myValue;
  }
  //MOZILLA/NETSCAPE support
  else if ( browser.isNS )
  {
    myField.focus();
    var startPos = myField.selectionStart;
    var oldLength = myField.value.length;
    if ( oldLength > 0 )
      myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring( startPos, oldLength );
    else
      myField.value = myValue;
  }
  else {
    myField.value += myValue;
  }
}

function getAbsElementYById(elmtId)
{
  var element = document.getElementById( elmtId );
  if ( element!=null ) return getAbsElementY( element );
  else                 return 0;
}
function getAbsElementY(e)
{
  var element = e;
  if ( element!=null ) return getAbsElementY( element );
  else                 return 0;
}
function getAbsElementXById(elmtId)
{
  var element = document.getElementById( elmtId );
  if ( element!=null ) return getAbsElementX( element );
  else                 return 0;
}
function getAbsElementY(element){
  var targetTop = 0;
  if (element.offsetParent) {
    while (element.offsetParent) {
      targetTop += element.offsetTop;
      element = element.offsetParent;
    }
  } else if (element.y) {
    targetTop += element.y;
  }
  return targetTop;
}
function getAbsElementX(element){
  var targetLeft = 0;
  if (element.offsetParent) {
    while (element.offsetParent) {
      targetLeft += element.offsetLeft;
      element = element.offsetParent;
    }
  } else if (element.x) {
    targetLeft += element.yx;
  }
  return targetLeft;
}

function getPositionYRelativeToDiv(element){
  var targetTop = 0;
  if (element.offsetParent) {
    while (element.offsetParent)
    {
      elementOffsetParent = element.offsetParent;
      if ( elementOffsetParent.tagName != null && ( elementOffsetParent.tagName == "DIV" || elementOffsetParent.tagName == "div" ) )
      {
        targetTop += element.offsetTop;
        break;
      }
      targetTop += element.offsetTop;
      element = elementOffsetParent;
    }
  } else if (element.y) {
    targetTop += element.y;
  }
  return targetTop;
}

function getPositionXRelativeToDiv(element){
  var targetLeft = 0;
  if (element.offsetParent) {
    while (element.offsetParent)
    {
      elementOffsetParent = element.offsetParent;
      if ( elementOffsetParent.tagName != null && ( elementOffsetParent.tagName == "DIV" || elementOffsetParent.tagName == "div" ) )
      {
        targetLeft += element.offsetLeft;
        break;
      }
      targetLeft += element.offsetLeft;
      element = elementOffsetParent;
    }
  } else if (element.x) {
    targetLeft += element.x;
  }
  return targetLeft;
}


// 10/2006: we do AJAX Queues now.
var __ajaxJobQueue = [];    // MAIN QUEUE: only one per page.
function ajaxJob() {
  this._submitUrl    = "";
  this._callbackFunc = null;
  this._callbackFuncParam = "";
}
function postXmlHttp( submitUrl, callbackFunc )
{
  var newJob = new ajaxJob();
  newJob._submitUrl    = submitUrl;
  newJob._callbackFunc      = callbackFunc;
  newJob._callbackFuncParam = "";
  __ajaxJobQueue.push( newJob );
  
  postXmlHttpRun();
}

var _postXmlHttpProcessPostChangeCallBack;
var _postXmlHttpProcessPostChangeCallBackParam = '';
var _xmlHttpRequestObj;
var __ajaxJobQueueRunning = 0;
function postXmlHttpRun()
{
  if ( __ajaxJobQueueRunning == 1 )
    return;

  if ( __ajaxJobQueue.length == 0 ) 
    return;

  __ajaxJobQueueRunning = 1;
  var ajaxJob = __ajaxJobQueue.shift();  // get the first job in the queue
  submitUrl    = ajaxJob._submitUrl;
  callbackFunc = ajaxJob._callbackFunc;

  _postXmlHttpProcessPostChangeCallBack = callbackFunc;
  try {
    _postXmlHttpProcessPostChangeCallBackParam = ajaxJob._callbackFuncParam;
  }
  catch (Exception) { _postXmlHttpProcessPostChangeCallBackParam = ""; };

  if(window.createRequest)
  {
    try{
      _xmlHttpRequestObj=window.createRequest();
      _xmlHttpRequestObj.open('POST',submitUrl,true);
      _xmlHttpRequestObj.onreadystatechange=postXmlHttpProcessPostChange;
      _xmlHttpRequestObj.send();
    }
    catch(ee){}
  }
  else if(window.XMLHttpRequest)
  {
    _xmlHttpRequestObj=new XMLHttpRequest();
//    _xmlHttpRequestObj.overrideMimeType('text/xml');
    _xmlHttpRequestObj.open('POST',submitUrl,true);
    _xmlHttpRequestObj.onreadystatechange=postXmlHttpProcessPostChange;
    _xmlHttpRequestObj.send("");
  }
  else if(window.ActiveXObject)
  {
    _xmlHttpRequestObj=new ActiveXObject("Microsoft.XMLHTTP");
    _xmlHttpRequestObj.open('POST',submitUrl,true);
    _xmlHttpRequestObj.onreadystatechange=postXmlHttpProcessPostChange;
    _xmlHttpRequestObj.send();
  }
};

function postXmlHttpProcessPostChange( )
{
  if( _xmlHttpRequestObj.readyState==4 && _xmlHttpRequestObj.status==200 )
  {
    setTimeout( _postXmlHttpProcessPostChangeCallBack, 10 );
    __ajaxJobQueueRunning = 0;
    setTimeout( postXmlHttpRun, 80 );
  }
}

function ebjs_debug( txt )
{
  document.getElementById( 'jsdebugpanel' ).innerHTML = document.getElementById( 'jsdebugpanel' ).innerHTML + ' ' + txt;
}

function ajax_getFormValues(fobj,valFunc)  // valFunc should pass in 'validate'
{
  var str = "";
  var valueArr = null;
  var val = "";
  var cmd = "";

  for(var i = 0;i < fobj.elements.length;i++)
  {
    switch(fobj.elements[i].type)
    {
      case "text":
        if(valFunc)
        {
          //use single quotes for argument so that the value of
          //fobj.elements[i].value is treated as a string not a literal
          cmd = valFunc + "(" + 'fobj.elements[i].value' + ")";
          val = eval(cmd)
        }

        str += fobj.elements[i].name + "=" + escape(fobj.elements[i].value) + "&";
        break;

      case "select-one":
        str += fobj.elements[i].name + "=" + fobj.elements[i].options[fobj.elements[i].selectedIndex].value + "&";
        break;
      
      default:
        str += fobj.elements[i].name + "=" + escape(fobj.elements[i].value) + "&";
        break;
    }
  }
  str = str.substr(0,(str.length - 1));
  return str;
}

function sidebar_postit_addnote( submitUrl, formName )
{
  submitUrl = submitUrl + '&note=' + unescape ( escape( $( formName+'_sidebar_postit_content').value ) );
  postXmlHttp( submitUrl, 'refreshSidebarPostit()' );
  $( formName+'_sidebar_postit_content').value = '';
}
function sidebar_compass_prev( submitUrl )
{
  submitUrl = submitUrl + '&nav=PREV&day=' + escape( document.forms['sidebar_fc_compass_form'].elements['daykey'].value );
  postXmlHttp( submitUrl, 'refreshCompassContent()' );
}
function sidebar_compass_next( submitUrl )
{
  submitUrl = submitUrl + '&nav=NEXT&day=' + escape( document.forms['sidebar_fc_compass_form'].elements['daykey'].value );
  postXmlHttp( submitUrl, 'refreshCompassContent()' );
}
function sidebar_compass_reload( submitUrl )
{
  submitUrl = submitUrl + '&nav=RELOAD&day=' + escape( document.forms['sidebar_fc_compass_form'].elements['daykey'].value );
  postXmlHttp( submitUrl, 'refreshCompassContent()' );
}
function sidebar_goal_reload( submitUrl )
{
  submitUrl = submitUrl + '&nav=RELOAD';
  postXmlHttp( submitUrl, 'refreshGoalContent()' );
}
function fc_compass_dragdrop( submitUrl )
{
  postXmlHttp( submitUrl, 'ozReload()' );
}
function hotlist_add_entry( submitUrl )
{
  postXmlHttp( submitUrl, 'refreshHotList()' );
}
function salesteam_user_add( submitUrl, userIds )
{
  postXmlHttp( submitUrl+'&uids='+userIds, 'refreshSalesTeam()' );
}
function salesteam_group_add( submitUrl, ugid )
{
  postXmlHttp( submitUrl+'&ugid='+ugid, 'refreshSalesTeam()' );
}
function fc_new_appointment( submitUrl, daystr, apptName, timeSlotId )
{
  fcCalRefreshInProgress = 1;
  postXmlHttp( submitUrl+'&daystr='+daystr+'&tsid='+timeSlotId+'&apptname='+escape(apptName), 'refreshFcApptList()' );
}

function ppolRefreshDailyNotes()
{
  var refreshDiv = document.getElementById('fcDailyNotes');
  if ( refreshDiv != null && _xmlHttpRequestObj.responseText.length>100 )
    refreshDiv.innerHTML = _xmlHttpRequestObj.responseText; 
  fcCalRefreshInProgress = 0;
}
  
function refreshHotList()
{
  var hotlist_content = document.getElementById('sidebar_hotlist_content');
  if ( hotlist_content != null )
    hotlist_content.innerHTML = _xmlHttpRequestObj.responseText; 
  hotlist_content = document.getElementById('topbar_hotlist_content');
  if ( hotlist_content != null )
    hotlist_content.innerHTML = _xmlHttpRequestObj.responseText; 
}

function refreshSidebarPostit()
{
  var postit_content = document.getElementById('sidebar_postit_today_content');
  if ( postit_content != null )
    postit_content.innerHTML = _xmlHttpRequestObj.responseText; 
  postit_content = document.getElementById('topbar_postit_today_content');
  if ( postit_content != null )
    postit_content.innerHTML = _xmlHttpRequestObj.responseText; 
}

function refreshSalesTeam()
{
  var sales_team_content = document.getElementById('sales_team_content');
  if ( sales_team_content != null )
    sales_team_content.innerHTML = _xmlHttpRequestObj.responseText; 
}


function refreshFcApptList()
{
  var refreshDiv = document.getElementById('fcApptDaily');
  if ( refreshDiv != null && _xmlHttpRequestObj.responseText.length>100 )
    refreshDiv.innerHTML = _xmlHttpRequestObj.responseText; 
  adjustApptsPositions();
  fcCalRefreshInProgress = 0;
}



function toggleCfMvFrame( cfMvFrameId, inputObjId )
{
  var cfMvFrame = document.getElementById(cfMvFrameId);
  var inputObj  = document.getElementById(inputObjId);
  if ( cfMvFrame.style.visibility == 'visible' ) hideCfMvFrame( cfMvFrame, inputObj, cfMvFrameId );
  else                                           showCfMvFrame( cfMvFrame, inputObj );
}
//Project Task : 14159 144 90246266  MS drop down menu must be closed to update
function toggleCfMvFrame1(cfMvFrameId, inputObjId)
{
    var cfMvFrame = document.getElementById(cfMvFrameId);
    var inputObj = document.getElementById(inputObjId);
    hideCfMvFrame(cfMvFrame, inputObj, cfMvFrameId);
}
 //Project Task : 14159 144 90246266  MS drop down menu must be closed to update
function hideCfMvFrameClose(cfMvFrameId, inputObjId)
{
    var cfMvFrame = document.getElementById(cfMvFrameId);
    var inputObj = document.getElementById(inputObjId);
    if (cfMvFrame.style.visibility == 'visible') closeFrameById(cfMvFrameId);
    else                                           showCfMvFrame(cfMvFrame, inputObj);
}
 //Project Task : 14159 144 90246266  MS drop down menu must be closed to update
function hideCfMvFrame( cfMvFrame, inputObj, cfMvFrameId )
{
  //closeFrameById( cfMvFrameId );

  var elList =  document.getElementsByTagName("INPUT");
  var newValue='';
  for (var i = 0; i < elList.length; i++)
  {
    if ( elList[i].name.substr(0,12+cfMvFrameId.length)== 'cfmvoption_'+cfMvFrameId+'_'
          && elList[i].checked
        )
      newValue += '['+elList[i].name.substr(12+cfMvFrameId.length)+'],';
  }

  if ( newValue.length>2 ) newValue = newValue.substr( 0, newValue.length-1 );
  inputObj.value = newValue;
}

function toggleUserMvFrame( cfMvFrameId1, cfMvFrameId2, inputObjId, hiddenUserIds )
{
  var cfMvFrame1 = document.getElementById(cfMvFrameId1);
  var cfMvFrame2 = null;
  if ( cfMvFrameId2 != null )
    cfMvFrame2 = document.getElementById(cfMvFrameId2);
  var inputObj  = document.getElementById(inputObjId);
  var hiddenUidObj  = document.getElementById(hiddenUserIds);

  if ( cfMvFrame1.style.visibility == 'visible' )
  {
    closeUserMvFrame( cfMvFrameId1, inputObj, hiddenUidObj );
  }
  else
  {
    if ( cfMvFrame2 != null )
    {
      closeFrameById( cfMvFrameId2 );
    }
    showCfMvFrameScroll( cfMvFrame1, inputObj, 0 );  // 0 =adjustWidth
  }
}
function closeUserMvFrame( cfMvFrameId, inputObj, hiddenUidObj )
{
  closeFrameById( cfMvFrameId );

  var elList =  document.getElementsByTagName("INPUT");
  var newValue='';
  var newIds='';
  for (var i = 0; i < elList.length; i++)
  {
    if ( elList[i].name.substr(0,10+cfMvFrameId.length)== 'mvoption_'+cfMvFrameId+'_' 
          && elList[i].checked
        )
    {
      newValue += '['+elList[i].name.substr(10+cfMvFrameId.length)+'],';
      newIds   += document.getElementById( 'mvuserid_'+cfMvFrameId+'_'+elList[i].name.substr(10+cfMvFrameId.length) ).value + ',';
    }
  }
  if ( newValue.length>2 ) newValue = newValue.substr( 0, newValue.length-1 );
  inputObj.value = newValue;
  hiddenUidObj.value = newIds;
}
function submitUserMvFrame( cfMvFrameId1, cfMvFrameId2, inputObjId, hiddenUserIds )
{
  var cfMvFrame1 = document.getElementById(cfMvFrameId1);
  var cfMvFrame2 = document.getElementById(cfMvFrameId2);
  var inputObj  = document.getElementById(inputObjId);
  var hiddenUidObj  = document.getElementById(hiddenUserIds);

  if ( cfMvFrame1 != null && cfMvFrame1.style.visibility == 'visible' )
  {
    closeUserMvFrame( cfMvFrameId1, inputObj, hiddenUidObj );
  }
  if ( cfMvFrame2 != null && cfMvFrame2.style.visibility == 'visible' )
  {
    closeUserMvFrame( cfMvFrameId2, inputObj, hiddenUidObj );
  }
}

function toggleFtWhFrame( cfMvFrameId, inputObjId )  // FtWh = FreeTextWithHint
{
  var cfMvFrame = document.getElementById(cfMvFrameId);
  var inputObj  = document.getElementById(inputObjId);
  if ( cfMvFrame.style.visibility == 'visible' ) closeFrameById( cfMvFrameId );
  else
  {

    showCfMvFrame( cfMvFrame, inputObj );
    ++adjustiFrameMaxZIndex;
    cfMvFrame.style.zIndex = adjustiFrameMaxZIndex;
  }
}
function closeFrameById( cfMvFrameId )  // FtWh = FreeTextWithHint
{
  //date issue in appt
  //var cfMvFrame = $(cfMvFrameId);
  var cfMvFrame = document.getElementById(cfMvFrameId);
  cfMvFrame.style.visibility = 'hidden';
  cfMvFrame.style.display = 'none';
  adjustiFrame( cfMvFrame );
}
function selectFtWhFrame( cfMvFrameId, inputObjId, newValue )  // FtWh = FreeTextWithHint
{
  //date issue in appt
  //$( inputObjId ).value = newValue;
  document.getElementById(inputObjId).value = newValue;  
  closeFrameById( cfMvFrameId );
}
  //Bug no: 3346: Date Selector needs to automatically close
//Thiru finds:ProjectTask Summary Page Start Date, End Date Change not working        :N2G-012   :28Feb2013
 function selectFtWhFramePrjTask( cfMvFrameId, inputObjId, newValue )  // FtWh = FreeTextWithHint
{
  $( inputObjId ).value = newValue;
  closeFrameById( cfMvFrameId );
}
  //Bug no: 3361: Calendar Appt bug - Times not changing- end time  / start time issue
function selectFtWhFrameAppt( cfMvFrameId, inputObjId, newValue )  // FtWh = FreeTextWithHint
{
  //Bug : 4195 End Time Missing  
  //$( inputObjId ).value = newValue;
  document.getElementById( inputObjId ).value = newValue;
  //Bug no: 3361: Calendar Appt bug - Times not changing- end time  / start time issue
  odRefreshApptEndTime();
  closeFrameById( cfMvFrameId );
}
function toggleCfCcFrame( cfMvFrameId, displayObjId )  // CfCc = CustomFieldColorCode
{
  //PPOL-266 Contact Edit form is not retaining all the populated fields in the form  
  /*if ( $(cfMvFrameId).style.visibility == 'visible' ) closeFrameById( cfMvFrameId );
  else                                                showCfMvFrame( $(cfMvFrameId), $(displayObjId) );*/
  //if ( (document.getElementById(cfMvFrameId)).style.visibility == 'visible' ) closeFrameById( cfMvFrameId );
  if ( (document.getElementById(cfMvFrameId)).style.visibility == 'visible' ) closeFrameById( cfMvFrameId );
  else                                                showCfMvFrame( document.getElementById(cfMvFrameId), document.getElementById(displayObjId) );
}
function selectCfCcFrame( cfMvFrameId, displayObjId, valueObjId, newValue )  // CfCc = CustomFieldColorCode
{
  //PPOL-266 Contact Edit form is not retaining all the populated fields in the form  
  /*$( displayObjId ).innerHTML = newValue;
  $( valueObjId ).value = newValue;*/
  document.getElementById( displayObjId ).innerHTML = newValue;
  document.getElementById( valueObjId ).value = newValue;

  closeFrameById( cfMvFrameId );
}
function togglePhoneFrame( cfMvFrameId, inputObjId, formName )
{
  var cfMvFrame = document.getElementById(cfMvFrameId);
  var inputObj  = document.getElementById(inputObjId);
  if ( cfMvFrame.style.visibility == 'visible' ) hidePhoneFrame( cfMvFrameId, inputObjId, formName );
  else                                           showCfMvFrameScroll( cfMvFrame, inputObj, 100 );
}
function hidePhoneFrame( cfMvFrameId, inputObjId, formName )
{
  closeFrameById( cfMvFrameId );

  var elList =  document.getElementsByTagName("INPUT");
  var rowNum = '0';
  for (var i = 0; i < elList.length; i++)
  {
    if ( elList[i].name == 'ahsPhbk_'+inputObjId+'_IDENTIFYING_ROW' )
      rowNum = elList[i].value;
  }

  var nb  = document.forms[formName].elements['ahsPhbk_'+inputObjId+'_'+rowNum+'_NB'].value;
  var ex  = document.forms[formName].elements['ahsPhbk_'+inputObjId+'_'+rowNum+'_EX'].value;
  var formatPhone = "";
  formatPhone = formatPhone + nb;
  if ( ex != '' ) formatPhone = formatPhone + ' x' + ex;
  $(inputObjId).value=formatPhone;
}

function toggleEmailFrame( cfMvFrameId, inputObjId, formName )
{
  var cfMvFrame = document.getElementById(cfMvFrameId);
  var inputObj  = document.getElementById(inputObjId);
  if ( cfMvFrame.style.visibility == 'visible' ) hideEmailFrame( cfMvFrameId, inputObjId, formName );
  else                                           showCfMvFrameScroll( cfMvFrame, inputObj, 100 );
}
function hideEmailFrame( cfMvFrameId, inputObjId, formName )
{
  closeFrameById( cfMvFrameId );

  var elList =  document.getElementsByTagName("INPUT");
  var rowNum = '0';
  for (var i = 0; i < elList.length; i++)
  {
    if ( elList[i].name == 'ahsEmbk_'+inputObjId+'_IDENTIFYING_ROW' )
      rowNum = elList[i].value;
  }

  $(inputObjId).value=document.forms[formName].elements['ahsEmbk_'+inputObjId+'_'+rowNum+'_EMAIL'].value;
}

function showCfMvFrame( cfMvFrame, inputObj )
{
  var maxHeight = 200;
  if (cfMvFrame.offsetHeight < maxHeight)
  {
    cfMvFrame.style.overflow = 'hidden';
  }
  else if (browser.isNS)
  {
    cfMvFrame.style.maxHeight = '200px';
    cfMvFrame.style.overflow = '-moz-scrollbars-vertical';
  }
  else
  {
    cfMvFrame.style.height = '200px';
    cfMvFrame.style.overflowY = 'auto';
  }

  cfMvFrame.scrollTop = 0;

  if ( browser.isIE )
  {
    var divParent = getDivContainer( cfMvFrame );
    if ( divParent != null && ( divParent.style.overflow == 'auto' || divParent.style.overflow == 'scroll' ) )
    {
      cfMvFrame.style.top   = ((getAbsElementY(inputObj)+inputObj.offsetHeight-getAbsElementY(divParent)) - 42) + "px";
      cfMvFrame.style.left  = (getAbsElementX(inputObj)                      -getAbsElementX(divParent)) + "px";
    }
    else
    {
      cfMvFrame.style.top   = ((getAbsElementY(inputObj)+inputObj.offsetHeight)-42) + "px";
      cfMvFrame.style.left  = (getAbsElementX(inputObj)                      ) + "px";
    }
  }
  else
  {
    try {
      var inputObjId = inputObj.getAttribute('id');
      if ( inputObjId.substring(0,4) == 'ajax' )
      {
        var divParent = getDivContainer( cfMvFrame );
        cfMvFrame.style.top   = (getAbsElementY(inputObj)+inputObj.offsetHeight-getAbsElementY(divParent) - 42) + "px";
        cfMvFrame.style.left  = (getAbsElementX(inputObj)                      -getAbsElementX(divParent)) + "px";
      }
      else
      {
        cfMvFrame.style.top   = (getAbsElementY(inputObj)+inputObj.offsetHeight - 42) + "px";
        cfMvFrame.style.left  = (getAbsElementX(inputObj)                      ) + "px";
      }
    }
    catch (Exception)
    {
      cfMvFrame.style.top   = (getAbsElementY(inputObj)+inputObj.offsetHeight - 42) + "px";
      cfMvFrame.style.left  = (getAbsElementX(inputObj)                      ) + "px";
    };
  }

  if ( inputObj.offsetWidth < 80 ) cfMvFrame.style.width = "100px";
  else                             cfMvFrame.style.width = (inputObj.offsetWidth+17) + "px";

  cfMvFrame.style.visibility = 'visible';
  cfMvFrame.style.display = 'block';
  adjustiFrame( cfMvFrame );
}

function showCfMvFrameScroll( cfMvFrame, inputObj, adjustWidth )
{
  var maxHeight = 200;
  cfMvFrame.scrollTop = 0;

  // Start playing
  cfMvFrame.style.top   = (getAbsElementY(inputObj)+inputObj.offsetHeight-45) + "px";
  cfMvFrame.style.left  = getAbsElementX(inputObj) + "px";
  //cfMvFrame.style.width = (inputObj.offsetWidth+67+adjustWidth) + "px";  width of popup
  cfMvFrame.style.width = (inputObj.offsetWidth+89+adjustWidth) + "px";

  cfMvFrame.style.visibility = 'visible';
  cfMvFrame.style.display = 'block';
  adjustiFrame( cfMvFrame );
}


                
var tipwidth='240px'; //default tooltip width
var tipbgcolor='#DDEEFF';  //tooltip bgcolor
var disappeardelay=250;  //tooltip disappear speed onMouseout (in miliseconds)
var vertical_offset="0px"; //horizontal offset of tooltip from anchor link
var horizontal_offset="-3px"; //horizontal offset of tooltip from anchor link

/////No further editting needed

var ie4=document.all;
var ns6=document.getElementById&&!document.all;

if (ie4||ns6)
  document.write('<div id="fixedtipdiv" style="visibility:hidden;width:'+tipwidth+';background-color:'+tipbgcolor+'" ></div>')

function getposOffset(what, offsettype)
{
  var totaloffset=(offsettype=="left")? what.offsetLeft : what.offsetTop;
  var parentEl=what.offsetParent;
  while (parentEl!=null){
    totaloffset=(offsettype=="left")? totaloffset+parentEl.offsetLeft : totaloffset+parentEl.offsetTop;
    parentEl=parentEl.offsetParent;
  }
  return totaloffset;
}


  function showhide(obj, e, visible, hidden, tipwidth)
  {
    if (ie4||ns6)
      dropmenuobj.style.left=dropmenuobj.style.top=-500
    if (tipwidth!=""){
      dropmenuobj.widthobj=dropmenuobj.style
      dropmenuobj.widthobj.width=tipwidth
    }
    if (e.type=="click" && obj.visibility==hidden || e.type=="mouseover")
      obj.visibility=visible
    else if (e.type=="click")
      obj.visibility=hidden
  }

  function iecompattest(){
    return (document.compatMode && document.compatMode!="BackCompat")? document.documentElement : document.body
  }

  function clearbrowseredge(obj, whichedge){
    var edgeoffset=(whichedge=="rightedge")? parseInt(horizontal_offset)*-1 : parseInt(vertical_offset)*-1
    if (whichedge=="rightedge"){
      var windowedge=ie4 && !window.opera? iecompattest().scrollLeft+iecompattest().clientWidth-15 : window.pageXOffset+window.innerWidth-15
      dropmenuobj.contentmeasure=dropmenuobj.offsetWidth
      if (windowedge-dropmenuobj.x < dropmenuobj.contentmeasure)
        edgeoffset=dropmenuobj.contentmeasure-obj.offsetWidth
    }
    else{
      var windowedge=ie4 && !window.opera? iecompattest().scrollTop+iecompattest().clientHeight-15 : window.pageYOffset+window.innerHeight-18
      dropmenuobj.contentmeasure=dropmenuobj.offsetHeight
      if (windowedge-dropmenuobj.y < dropmenuobj.contentmeasure)
        edgeoffset=dropmenuobj.contentmeasure+obj.offsetHeight
    }
    return edgeoffset
  }

  function fixedtooltip(menucontents, obj, e, tipwidth){
    if (window.event) event.cancelBubble=true
    else if (e.stopPropagation) e.stopPropagation()
      clearhidetip()
    dropmenuobj=document.getElementById? document.getElementById("fixedtipdiv") : fixedtipdiv
    dropmenuobj.innerHTML=unescape(menucontents);

    if (ie4||ns6){
      showhide(dropmenuobj.style, e, "visible", "hidden", tipwidth)
      dropmenuobj.x=getposOffset(obj, "left")
      dropmenuobj.y=getposOffset(obj, "top")
      dropmenuobj.style.left=dropmenuobj.x-clearbrowseredge(obj, "rightedge")+"px"
      dropmenuobj.style.top=dropmenuobj.y-clearbrowseredge(obj, "bottomedge")+obj.offsetHeight+"px"
    }
  }
  function fixedtooltipadv(p1, p2, p3, p4, obj, e, tipwidth){
    if (window.event) event.cancelBubble=true
    else if (e.stopPropagation) e.stopPropagation()
      clearhidetip()
    dropmenuobj=document.getElementById? document.getElementById("fixedtipdiv") : fixedtipdiv
    dropmenuobj.innerHTML=unescape( fixedtooltipadv_getcontent(p1, p2, p3, p4, obj) );

    if (ie4||ns6){
      showhide(dropmenuobj.style, e, "visible", "hidden", tipwidth)
      dropmenuobj.x=getposOffset(obj, "left")
      dropmenuobj.y=getposOffset(obj, "top")
      dropmenuobj.style.left=dropmenuobj.x-clearbrowseredge(obj, "rightedge")+"px"
      dropmenuobj.style.top=dropmenuobj.y-clearbrowseredge(obj, "bottomedge")+obj.offsetHeight+"px"
    }
  }
  function fixedtooltipAdjust(menucontents, obj, e, tipwidth){
    if (window.event) event.cancelBubble=true
    else if (e.stopPropagation) e.stopPropagation()
      clearhidetip()
    dropmenuobj=document.getElementById? document.getElementById("fixedtipdiv") : fixedtipdiv
    dropmenuobj.innerHTML=unescape(menucontents);

    if (ie4||ns6){
      showhide(dropmenuobj.style, e, "visible", "hidden", tipwidth)
      dropmenuobj.x=getposOffset(obj, "left")
      dropmenuobj.y=getposOffset(obj, "top")

      // 06/22/2006
      {
        var objparent = getDivContainer( obj );
        if ( objparent != null )
        {
          dropmenuobj.x = dropmenuobj.x - objparent.scrollLeft;
          dropmenuobj.y = dropmenuobj.y - objparent.scrollTop;
        }
      }

      dropmenuobj.style.left=dropmenuobj.x-clearbrowseredge(obj, "rightedge")+"px"
      dropmenuobj.style.top=dropmenuobj.y-clearbrowseredge(obj, "bottomedge")+obj.offsetHeight+"px"
    }
  }

  function hidetip(e){
    if (typeof dropmenuobj!="undefined"){
      if (ie4||ns6)
        dropmenuobj.style.visibility="hidden"
    }
  }

  function delayhidetip(){
    if (ie4||ns6)
      delayhide=setTimeout("hidetip()",disappeardelay)
  }

  function longdelayhidetip(){
    if (ie4||ns6)
      delayhide=setTimeout("hidetip()",2000)
  }

  function clearhidetip(){
    if (typeof delayhide!="undefined")
    clearTimeout(delayhide)
  }


function incbar_selectTab( tabId )
{
  document.getElementById('incbar_mortgage_calc').style.display="none";
  document.getElementById('incbar_post_it').style.display="none";
  document.getElementById( tabId ).style.display="block";
  return;
}

function incbar_mortgageCalcDoSum() { 
  var mi = document.incbar_mortgageCalc.IR.value / 1200;
  var base = 1;
  var mbase = 1 + mi;
  for (i=0; i<document.incbar_mortgageCalc.YR.value * 12; i++)
  {
    base = base * mbase; 
  }
  document.incbar_mortgageCalc.PI.value = floor(document.incbar_mortgageCalc.LA.value * mi / ( 1 - (1/base))); 
  document.incbar_mortgageCalc.MT.value = floor(document.incbar_mortgageCalc.AT.value / 12); 
  document.incbar_mortgageCalc.MI.value = floor(document.incbar_mortgageCalc.AI.value / 12); 
  var dasum = document.incbar_mortgageCalc.LA.value * mi / ( 1 - (1/base)) +        document.incbar_mortgageCalc.AT.value / 12 +         document.incbar_mortgageCalc.AI.value / 12;  document.incbar_mortgageCalc.MP.value = floor(dasum);
}

function overlaycloseall( divid )
{
    if ( divid != 'divbar_new' )  overlayclose('divbar_new');
    if ( divid != 'divbar_bookmarks' )  overlayclose('divbar_bookmarks');
    if ( divid != 'divbar_hotlist' ) overlayclose('divbar_hotlist');
    if ( divid != 'divbar_recent_items' ) overlayclose('divbar_recent_items');
    if ( divid != 'divbar_tools' ) overlayclose('divbar_tools');
    if ( divid != 'divbar_jumpto' ) overlayclose('divbar_jumpto');
}

function allincbar_overlay_bookmark( in_responseText, in_param )      { $('divbar_bookmarks').innerHTML = in_responseText; }
function allincbar_overlay_hotlist( in_responseText, in_param )       { $('divbar_hotlist').innerHTML = in_responseText; }
function allincbar_overlay_recent_items( in_responseText, in_param )  { $('divbar_recent_items').innerHTML = in_responseText; }
function allincbar_overlay_recent_tools( in_responseText, in_param )  { $('divbar_tools').innerHTML = in_responseText; }
function overlay(curobj, subobjid)
{
  var subobj=document.getElementById(subobjid);
  subobj.style.left=getposOffset(curobj, "left")+"px";
  subobj.style.top=(getposOffset(curobj, "top")+16)+"px";
  var visible=(subobj.style.display!="none");
  if (visible) subobj.style.display="none";
  else         subobj.style.display="block";
  ++adjustiFrameMaxZIndex;
  subobj.style.zIndex = adjustiFrameMaxZIndex;

  if ( subobjid == 'divbar_bookmarks' )
  {
    SimpleAJAXCall ( 'xhpCmnGetData.jsp'+genappend_submiturl+'&type=ALLINCBAR_BOOKMARK', allincbar_overlay_bookmark, 'POST', '' );
  }
  if ( subobjid == 'divbar_hotlist' )
  {
    SimpleAJAXCall ( 'xhpCmnGetData.jsp'+genappend_submiturl+'&type=ALLINCBAR_HOTLIST', allincbar_overlay_hotlist, 'POST', '' );
  }
  if ( subobjid == 'divbar_recent_items' )
  {
    SimpleAJAXCall ( 'xhpCmnGetData.jsp'+genappend_submiturl+'&type=ALLINCBAR_RECENT_ITEMS', allincbar_overlay_recent_items, 'POST', '' );
  }
  if ( subobjid == 'divbar_tools' )
  {
    SimpleAJAXCall ( 'xhpCmnGetData.jsp'+genappend_submiturl+'&type=ALLINCBAR_TOOLS', allincbar_overlay_recent_tools, 'POST', '' );
  }
  
  
  return false;
}

  function overlayAdjust(curobj, subobj)
  {
    if (document.getElementById)
    {
      var subobj=document.getElementById(subobj)
      subobj.style.left=getAbsElementX(curobj)+"px";
      subobj.style.top=(getAbsElementY(curobj)+16)+"px";
      var visible=(subobj.style.display!="none");
      if (visible) subobj.style.display="none";
      else         subobj.style.display="block";
      return false;
    }
    else
      return true;
  }

  function overlayclose(subobj){
    var o = document.getElementById(subobj);
    if ( o!=null )
      o.style.display="none"
  }


//added by janet 2005.12.9--begin
function jumpChart(submitUrl,portId,obj)
{ 
  submitUrl = submitUrl+'&param='+obj.options[obj.selectedIndex].value+"&portId="+portId;
  postXmlHttp( submitUrl, 'refreshChart('+portId+')');;
}
function refreshChart(portId)
{
  var div="chart_"+portId;
  var chart = document.getElementById(div);
  if ( chart != null )
     chart.innerHTML = _xmlHttpRequestObj.responseText; 
}
function jumpChart2(submitUrl,portId,param)
{ 
  var all=document.getElementById("portlet_"+portId+"_all");
  var open=document.getElementById("portlet_"+portId+"_open");
  if(param=="ALL"){
    open.removeAttribute("bgColor");
    all.setAttribute("bgColor","#ccccdd");
  }else{
    all.removeAttribute("bgColor");
    open.setAttribute("bgColor","#ccccdd");
  }
  
  submitUrl = submitUrl+'&param='+param+"&portId="+portId
  postXmlHttp( submitUrl, 'refreshChart('+portId+')');;
}
//added by janet 2005.12.9--end



// Mouse Over Script Start
ajax_mouseover_timerid = -1;
ajax_mouseover_objtype = '';
ajax_mouseover_objid   = '';
ajax_mouseover_repeatid = ''; // added by siva
ajax_mouseover_inprogress = 0;
currMouseX = 0;
currMouseY = 0;
var ajaxCurrMouseX = 0;
var ajaxCurrMouseY = 0;
function ajax_mouseover( ajaxMouseOverObjType, ajaxMouseOverObjId )
{
  
  if ( ajax_mouseover_snapshot_yesno == 'N' )
    return;

  ajaxCurrMouseX = window.event.clientX+document.body.scrollLeft;
  ajaxCurrMouseY = window.event.clientY+document.body.scrollTop;
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }
  
  if ( ajax_mouseover_inprogress == 0 )
  {
    ajax_mouseover_objtype = ajaxMouseOverObjType;
    ajax_mouseover_objid   = ajaxMouseOverObjId;

    ajax_mouseover_timerid = setTimeout( 'ajax_mouseover_action()', 1000 );
  }
}

function ajax_mouseover_bg( ajaxMouseOverObjType, ajaxMouseOverObjId )
{
  
  if ( ajax_mouseover_snapshot_yesno == 'N' )
    return;

  ajaxCurrMouseX = window.event.clientX+document.body.scrollLeft;
  ajaxCurrMouseY = window.event.clientY+document.body.scrollTop;
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }
  
  if ( ajax_mouseover_inprogress == 0 )
  {
    ajax_mouseover_objtype = ajaxMouseOverObjType;
    ajax_mouseover_objid   = ajaxMouseOverObjId;

    ajax_mouseover_timerid = setTimeout( 'ajax_mouseover_action_bg()', 1000 );
  }
}

function ajax_mouseoverrepeat( ajaxMouseOverObjType, ajaxMouseOverObjId, ajaxRepeatId )       // Added by siva to pass the RepeatId for Non-Master(Recurring) Appts.
{
  if ( ajax_mouseover_snapshot_yesno == 'N' )
    return;

  ajaxCurrMouseX = window.event.clientX+document.body.scrollLeft;
  ajaxCurrMouseY = window.event.clientY+document.body.scrollTop;
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }

  if ( ajax_mouseover_inprogress == 0 )
  {
    ajax_mouseover_objtype = ajaxMouseOverObjType;
    ajax_mouseover_objid   = ajaxMouseOverObjId;
    ajax_mouseover_repeatid = ajaxRepeatId;

    ajax_mouseover_timerid = setTimeout( 'ajax_mouseover_action1()', 1000 );
  }
}

function ajax_mouseout( ajaxMouseOverObjType, ajaxMouseOverObjId )
{
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }
  
  if ( ajax_mouseover_snapshot_hide != 'NEVER' )
  {
    if ( $('ajax_mouseover_snapshot_div') != null )
      setTimeout( 'ajax_mouseover_hidenapshot()', ajax_mouseover_snapshot_hide*1.0 );
  }
}

function ajax_mouseover_action()
{
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }
  ajax_mouseover_inprogress = 1;
  submitUrl = ajax_mouseover_submiturl + '&objtype=' + ajax_mouseover_objtype + '&objid=' + escape(ajax_mouseover_objid);
  try {
    if ( ajax_mouseover_email_contactid > 0 )
      submitUrl = submitUrl + '&eml_contactid=' + ajax_mouseover_email_contactid;
  }
  catch ( e ) {};
  postXmlHttp( submitUrl, 'ajax_mouseover_showsnapshot()' );
}

function ajax_mouseover_action_bg()
{
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }
  ajax_mouseover_inprogress = 1;
  submitUrl = ajax_mouseover_submiturl_bg + '&objtype=' + ajax_mouseover_objtype + '&objid=' + escape(ajax_mouseover_objid);
  try {
    if ( ajax_mouseover_email_contactid > 0 )
      submitUrl = submitUrl + '&eml_contactid=' + ajax_mouseover_email_contactid;
  }
  catch ( e ) {};
  postXmlHttp( submitUrl, 'ajax_mouseover_showsnapshot_bg()' );
}

function ajax_mouseover_action1()          // Added by siva to pass the RepeatId for Non-Master(Recurring) Appts.
{
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }
  ajax_mouseover_inprogress = 1;
  submitUrl = ajax_mouseover_submiturl + '&objtype=' + ajax_mouseover_objtype + '&objid=' + escape(ajax_mouseover_objid) + '&repeatid=' + ajax_mouseover_repeatid ;
  try {
    if ( ajax_mouseover_email_contactid > 0 )
      submitUrl = submitUrl + '&eml_contactid=' + ajax_mouseover_email_contactid;
  }
  catch ( e ) {};
  postXmlHttp( submitUrl, 'ajax_mouseover_showsnapshot()' );
}

function ajax_mouseover2( ajaxMouseOverObjType, ajaxMouseOverObjId )
{
  ajaxCurrMouseX = window.event.clientX+document.body.scrollLeft;
  ajaxCurrMouseY = window.event.clientY+document.body.scrollTop;
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }
  
  if ( ajax_mouseover_inprogress == 0 )
  {
    ajax_mouseover_objtype = ajaxMouseOverObjType;
    ajax_mouseover_objid   = ajaxMouseOverObjId;
    ajax_mouseover_timerid = setTimeout( 'ajax_mouseover_action2()', 3000 );
  }
}
function ajax_mouseover_action2()
{
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }
  ajax_mouseover_inprogress = 1;
  submitUrl = ajax_mouseover_submiturl + '&objtype=' + ajax_mouseover_objtype + '&objid=' + escape(ajax_mouseover_objid) ;
  SimpleAJAXCall ( submitUrl, ajax_mouseover_showsnapshot2, 'POST', '' );
}
function ajax_mouseout2( ajaxMouseOverObjType, ajaxMouseOverObjId )
{
  if ( ajax_mouseover_timerid != -1 )
  {
    clearTimeout(ajax_mouseover_timerid);
    ajax_mouseover_timerid = -1;
  }
  if ( $('ajax_mouseover_snapshot_div') != null )
    ajax_mouseover_timerid = setTimeout( 'ajax_mouseover_hidenapshot()', 3000 );
}
function ajax_mouseover_showsnapshot2( in_responseText, in_param )
{
  var snapshot_div = document.getElementById('ajax_mouseover_snapshot_div');
  if ( snapshot_div != null )
  {
    snapshot_div.innerHTML = in_responseText; 

    snapshot_div.style.position = "absolute";
    snapshot_div.style.width = "540px";
    snapshot_div.style.overflow = 'scroll';

    if ( ajaxCurrMouseX + 525 > getBrowserSizeX() )
      snapshot_div.style.left  = ( getBrowserSizeX()-540 ) + "px";
    else
      snapshot_div.style.left  = (ajaxCurrMouseX+5) + "px";

    snapshot_div.style.top   = (ajaxCurrMouseY+1) + "px";
    snapshot_div.style.visibility = 'visible';
    snapshot_div.style.display = "block";
    ++adjustiFrameMaxZIndex;
    snapshot_div.style.zIndex = adjustiFrameMaxZIndex;
    adjustiFrame( snapshot_div );
    ajax_mouseover_inprogress = 0;
  }
}
function ajax_donothing( in_responseText, in_param )
{
}

function ajax_mouseover_showsnapshot()
{
  var snapshot_div = document.getElementById('ajax_mouseover_snapshot_div');
  if ( snapshot_div != null )
  {
    snapshot_div.innerHTML = _xmlHttpRequestObj.responseText; 

    snapshot_div.style.position = "absolute";
    snapshot_div.style.width = "360px";
    
    if ( ajaxCurrMouseX + 365 > getBrowserSizeX() )
      snapshot_div.style.left  = ( getBrowserSizeX()-380 ) + "px";
    else
      snapshot_div.style.left  = (ajaxCurrMouseX+5) + "px";

    snapshot_div.style.top   = (ajaxCurrMouseY+1) + "px";
    snapshot_div.style.visibility = 'visible';
    snapshot_div.style.display = "block";
    adjustiFrame( snapshot_div );
    ajax_mouseover_inprogress = 0;
  }
}
function ajax_mouseover_showsnapshot_bg()
{
  var snapshot_div = document.getElementById('ajax_mouseover_snapshot_div');
  if ( snapshot_div != null )
  {
    snapshot_div.innerHTML = _xmlHttpRequestObj.responseText; 

    snapshot_div.style.position = "absolute";
    // snapshot_div.style.width = "360px";
    
    if ( ajaxCurrMouseX + 365 > getBrowserSizeX() )
      snapshot_div.style.left  = ( getBrowserSizeX()-380 ) + "px";
    else
      snapshot_div.style.left  = (ajaxCurrMouseX+5) + "px";

    snapshot_div.style.top   = (ajaxCurrMouseY+1) + "px";
    snapshot_div.style.visibility = 'visible';
    snapshot_div.style.display = "block";
    adjustiFrame( snapshot_div );
    ajax_mouseover_inprogress = 0;
  }
}
function ajax_mouseover_hidenapshot()
{
  if ( ajax_mouseover_inprogress == 1 )
    return;
  var snapshot_div = document.getElementById('ajax_mouseover_snapshot_div');
  if ( snapshot_div != null )
  {
    snapshot_div.style.display = "none";
    snapshot_div.style.visibility = "hidden";
    adjustiFrame( snapshot_div );
    ajax_mouseover_inprogress = 0;
  }
}
// Mouse Over Script End

//this fuctions is added by Janet 2006.2.22

function set_radio_value ( formName, elemName, selectedValue)
{
  var inputs = document.getElementsByTagName ('input');
  if (inputs)
  {
    for (var i = 0; i < inputs.length; ++i)
    {
      if (inputs[i].type == 'radio' && inputs[i].name == elemName && inputs[i].value == selectedValue )
      {
        inputs[i].checked = true;
        break;
      }
    }
  }
}

function set_select_value ( formName, elemName, selectedValue)
{
 var elem= document.forms[formName].elements[elemName].options;
 for ( var i=0; i< elem.length; i++)
 {
   if ( elem[i].value == selectedValue )
   {
     elem[i].selected = true ;
     break;
   }
 }
}

function cf_hour_min_onchange( formName, fieldName )
{
  var s1 = $( formName + '_' + fieldName + '_HH' ).value;
  var s2 = $( formName + '_' + fieldName + '_MM' ).value;
  var s3 = $( formName + '_' + fieldName + '_AP' ).value;
  if ( s1 == 'NA' || s2 == 'NA' || s3 == 'NA' )
    $( formName + '_' + fieldName ).value = '';
  else
    $( formName + '_' + fieldName ).value = s1 + ':' + s2 + ' ' + s3;
}

function search_select_all_all( formName, fieldPrefix )
{
  if ( document.forms[formName].select_all_all_flag.value=='N' )
  {
    document.forms[formName].select_all_all_flag.value = 'Y';
    ToggleSet('select_all_all_msg','block');
    var elList =  document.getElementsByTagName("INPUT");
    for (var i = 0; i < elList.length; i++)
    {
      if ( elList[i].name.substr(0,fieldPrefix.length)==fieldPrefix )
      {
        elList[i].checked = true;
        elList[i].disabled = true;
      }
    }
  }
  else
  {
    document.forms[formName].select_all_all_flag.value = 'N';
    ToggleSet('select_all_all_msg','none');
    var elList =  document.getElementsByTagName("INPUT");
    for (var i = 0; i < elList.length; i++)
    {
      if ( elList[i].name.substr(0,fieldPrefix.length)==fieldPrefix )
      {
        elList[i].checked = false;
        elList[i].disabled = false;
      }
    }
  }
  return false;
}


function cf_sms_phn_onchange( txtField, uniqK )
{
  var s1 = txtField.value;
  var s2 = $( uniqK+'_car' ).value;
  if ( s1.indexOf(' ') >= 0 || s1.indexOf('-')>=0 || s1.indexOf('(')>=0 || s1.indexOf(')')>=0 )
    alert( 'Please use number only. Please avoid [SPACE], - ( ) ... ' );
  if ( s1 == '' )
  {
    $( uniqK+'_display' ).innerHTML = '';
    $( uniqK+'_k' ).value = '';
  }
  else
  {
    $( uniqK+'_display' ).innerHTML = s1 + '@' + s2;
    $( uniqK+'_k' ).value = s1 + '@' + s2;
  }
}

function cf_sms_car_onchange( selField, uniqK )
{
  var s1 = $( uniqK+'_phn' ).value;
  var s2 = selField.value;
  if ( s2 == '' )
  {
    $( uniqK+'_display' ).innerHTML = '';
    $( uniqK+'_k' ).value = '';
  }
  else
  {
    $( uniqK+'_display' ).innerHTML = s1 + '@' + s2;
    $( uniqK+'_k' ).value = s1 + '@' + s2;
  }
}
/*
  function mobileCarrierOnChange( selObj )
  {
    var selValue = selObj.options[selObj.selectedIndex].value;  
    if ( selValue != '' )
    {
      document.TblActionForm.email.value = document.TblActionForm.phone1.value+document.TblActionForm.phone2.value+document.TblActionForm.phone3.value+'@'+selValue;
    }
  }
  
  function phoneOnChange()
  {
    var selObj = document.TblActionForm.mobileCarrier;
    var selValue = selObj.options[selObj.selectedIndex].value;  
    if ( selValue != '' )
    {
      document.TblActionForm.email.value = document.TblActionForm.phone1.value+document.TblActionForm.phone2.value+document.TblActionForm.phone3.value+'@'+selValue;
    }
  }
*/
  
var _gPpolSidebarShow= '';  // this is used in summary pages, so that when minimized, a single click would change url
var _gPpolSidebarDisplaying = '';
var _gPpolSidebarDisplayingId = '';
function ppolMinimizePpolSidebar( cat, pageCat )  // cat = 'ORG', 'PSN', 'OPP'
{
  _gPpolSidebarShow = 'N';
  
  if ( cat == 'ORG' )
    SimpleAJAXCall ( 'xhpCustomerNew.jsp'+genappend_submiturl+'&minSB=Y&pc='+pageCat, ppolMinimizePpolSidebarRefresh, 'POST', '' );

  if ( cat == 'PSN' )
    SimpleAJAXCall ( 'xhpContactNew.jsp'+genappend_submiturl+'&minSB=Y&pc='+pageCat, ppolMinimizePpolSidebarRefresh, 'POST', '' );
  
  if ( cat == 'OPP' )
    SimpleAJAXCall ( 'xhpOppNew.jsp'+genappend_submiturl+'&minSB=Y&pc='+pageCat, ppolMinimizePpolSidebarRefresh, 'POST', '' );
}
function ppolMinimizePpolSidebarRefresh(  in_responseText, in_param )
{
  //$( 'ppolSidebarDiv' ).innerHTML = in_responseText;
    document.getElementById( 'ppolSidebarDiv' ).innerHTML = in_responseText;
}

function ppolMaxmizePpolSidebar( cat, pageCat )
{
  _gPpolSidebarShow = 'Y';

  if ( cat == 'ORG' )
    SimpleAJAXCall ( 'xhpCustomerNew.jsp'+genappend_submiturl+'&maxSB=Y&pc='+pageCat+'&dispCat='+_gPpolSidebarDisplaying+'&dispId='+_gPpolSidebarDisplayingId, ppolMinimizePpolSidebarRefresh, 'POST', '' );

  if ( cat == 'PSN' )
    SimpleAJAXCall ( 'xhpContactNew.jsp'+genappend_submiturl+'&maxSB=Y&pc='+pageCat+'&dispCat='+_gPpolSidebarDisplaying+'&dispId='+_gPpolSidebarDisplayingId, ppolMinimizePpolSidebarRefresh, 'POST', '' );
  
  if ( cat == 'OPP' )
    SimpleAJAXCall ( 'xhpOppNew.jsp'+genappend_submiturl+'&maxSB=Y&pc='+pageCat+'&dispCat='+_gPpolSidebarDisplaying+'&dispId='+_gPpolSidebarDisplayingId, ppolMinimizePpolSidebarRefresh, 'POST', '' );
}

function LTrim(VALUE)
{
  var v_length = VALUE.length;
  if(v_length < 1)
    return"";

  var strTemp = "";

  var iTemp = 0;
  while(iTemp < v_length)
  {
    //if(VALUE.charAt(iTemp) == w_space || VALUE.charAt(iTemp)==w_enter || VALUE.charAt(iTemp)==w_back || VALUE.charAt(iTemp)==w_newline)
    if(VALUE.charCodeAt(iTemp)==32 || VALUE.charCodeAt(iTemp)==13 || VALUE.charCodeAt(iTemp)==10)
    {
    }
    else
    {
      strTemp = VALUE.substring(iTemp,v_length);
      break;
    }
    iTemp = iTemp + 1;
  } //End While
  return strTemp;
}

function RTrim(VALUE)
{
  var v_length = VALUE.length;
  if(v_length < 1)
    return"";

  var strTemp = "";
  var iTemp = v_length -1;
  while(iTemp > -1)
  {
    //if(VALUE.charAt(iTemp) == w_space || VALUE.charAt(iTemp)==w_enter || VALUE.charAt(iTemp)==w_back || VALUE.charAt(iTemp)==w_newline)
    if(VALUE.charCodeAt(iTemp)==32 || VALUE.charCodeAt(iTemp)==13 || VALUE.charCodeAt(iTemp)==10)
    {
    }
    else
    {
      strTemp = VALUE.substring(0,iTemp +1);
      break;
    }
    iTemp = iTemp-1;
  } //End While
  return strTemp;
} //End Function

function ALLTrim(VALUE)
{
  return RTrim(LTrim(VALUE));
}

/**
  * Function Name: tbl_TRMouseOver
  * Function: It updates the backgroud-color of '<tr>' tag when mouse overing.
  *           So it can be different from others. 
  *
  * @param    id       ID of <tr> tag
  *           oldId    ID of Clicked <tr> tag
  *           colorId  Log the tag bgcolor before update
  *           bgcolor  Backgroud-Color to Set
  *
  * @author   qmLiang
  * @since    2006-8-18 16:08:19
  * @version  1.0
  */
function tbl_TRMouseOver(id,oldId,colorId,bgcolor)
{
  id = ALLTrim(id);
  oldId = ALLTrim(oldId);
  colorId = ALLTrim(colorId);
  bgcolor = ALLTrim(bgcolor);
  //this row has be clicked,then do nothing
  if(oldId != '' && id == document.getElementById(oldId).value)
    return;
  if(bgcolor == '')
    bgcolor = "#FFFFFF";
    
  //log the original bgcolor of this row
  document.getElementById(colorId).value = document.getElementById(id).style.backgroundColor;
  //update the bgcolor of this row
  document.getElementById(id).style.backgroundColor=bgcolor;
}//End Function

/**
  * Function Name: tbl_TRMouseOut
  * Function: It updates the backgroud-color of '<tr>' tag to original when mouse outed.
  *
  * @param    id       ID of <tr> tag
  *           oldId    ID of Clicked <tr> tag
  *           colorId  Original bgcolor of the tag
  *
  * @author   qmLiang
  * @since    2006-8-18 16:09:19
  * @version  1.0
  */
function tbl_TRMouseOut(id,oldId,colorId)
{
  id = ALLTrim(id);
  oldId = ALLTrim(oldId);
  colorId = ALLTrim(colorId);
  //this row has be clicked,then do nothing
  if(oldId != '' && id == document.getElementById(oldId).value)
    return;
    
  var bgcolor = "#FFFFFF";
  //get the original bgcolor of this row
  if(colorId != '' && document.getElementById(colorId).value != '')
    bgcolor = document.getElementById(colorId).value;
  //update the bgcolor of this row to original
  document.getElementById(id).style.backgroundColor=bgcolor;
}//End Function

/**
  * Function Name: tbl_TRClick
  * Function: It updates the backgroud-color of clicked tag last time to original when mouse click.
  *           Then log the tag id replace the old one.
  *
  * @param    id          ID of <tr> tag
  *           oldId       ID of Clicked <tr> tag
  *           oldColorId  Original bgcolor of clicked tag
  *           curColorId  Original bgcolor of clicking tag
  *
  * @author   qmLiang
  * @since    2006-8-18 16:11:19
  * @version  1.0
  */
function tbl_TRClick(id,oldId,oldColorId,curColorId)
{
  id = ALLTrim(id);
  oldId = ALLTrim(oldId);
  oldColorId = ALLTrim(oldColorId);
  curColorId = ALLTrim(curColorId);
  //this row has be clicked,then do nothing
  if(oldId != '' && id == document.getElementById(oldId).value)
    return;
    
  var bgcolor = "#FFFFFF";
  //get the original bgcolor of clicked row
  if(oldColorId != '' && document.getElementById(oldColorId).value != '')
    bgcolor = document.getElementById(oldColorId).value;
  //update the bgcolor of clicked row to original
  if(oldId != '' && document.getElementById(oldId).value != ''){
    var oldTag = document.getElementById(oldId).value;
    document.getElementById(oldTag).style.backgroundColor=bgcolor;
  }
  //log the original bgcolor of clicking row
  document.getElementById(oldColorId).value = document.getElementById(curColorId).value;
  //log the id of clicking row
  document.getElementById(oldId).value = id;
}//End Function

/**
  * Function Name: selectCBAllGeneric
  * Function: Select all checkbox.
  *
  * @param    name    Name of Checkbox
  *           allObj  Event Target Object
  *
  * @author   qmLiang
  * @since    2006-8-22 15:10:19
  * @version  1.0
  */
function selectCBAllGeneric(name,allObj)
{
  var elList =  document.getElementsByTagName("INPUT");
  for (var i = 0; i < elList.length; i++)
  {
    if (elList[i].name.substr(0,name.length)==name)
      elList[i].checked = allObj.checked;
  }//end for i
}//End Function

function newSidebarAdjustHeight()
{
  if ( $('NEWSIDEBAR_Y') != null )
  {
    var newSidebarHeightDivH = getBrowserSizeY()-getAbsElementY($('NEWSIDEBAR_Y'));
    if (!browser.isIE) newSidebarHeightDivH = newSidebarHeightDivH-20;
    else               newSidebarHeightDivH = newSidebarHeightDivH-2;
    if ( newSidebarHeightDivH < 200 ) newSidebarHeightDivH = 200;
//    $('NEWSIDEBAR_Y').style.height = "" + newSidebarHeightDivH + "px";
      document.getElementById('NEWSIDEBAR_Y').style.height = "" + newSidebarHeightDivH + "px";

  }
}



function showHideExtraMenu()
{
    currMouseX = window.event.clientX+document.body.scrollLeft;
    currMouseY = window.event.clientY+document.body.scrollTop;

    $('xtraAppMenu').style.width = "600px";
    $('xtraAppMenu').style.top   = (currMouseY+2) + "px";
    $('xtraAppMenu').style.left  = ( getBrowserSizeX()-600 ) / 2  + "px";

    Toggle( 'xtraAppMenu' );
    adjustiFrameMaxZIndex = adjustiFrameMaxZIndex + 1;
    $('xtraAppMenu').style.zIndex = adjustiFrameMaxZIndex;
}


function chatOp_MonitorLiveChat()
{
  SimpleAJAXCall ( ajax_livechat_monitor_url+'&opMonitorLiveChat=Y', chatOp_MonitorLiveChatRefresh, 'POST', '' )
//  postXmlHttp( ajax_livechat_monitor_url+'&opMonitorLiveChat=Y', 'chatOp_MonitorLiveChatRefresh()' );
}
function chatOp_MonitorLiveChatRefresh( in_responseText, in_param  )
{
  var returnHtml = ALLTrim( in_responseText );
  if ( returnHtml.length>5 )
  {
    var inQueueDiv = document.getElementById('ajax_popup_notify_div');
    if ( inQueueDiv != null )
    {
      inQueueDiv.innerHTML = returnHtml;
      inQueueDiv.style.width = "600px";
      inQueueDiv.style.height = "40px";
      inQueueDiv.position = "relative";
      inQueueDiv.style.visibility = 'visible';
      inQueueDiv.style.display = "block";
      inQueueDiv.style.top   = "0px";
      inQueueDiv.style.left  = "0px";
      inQueueDiv.style.zIndex = 1000000;
      
      EvalSound('sound1');
//      DHTMLSound( 'http://127.0.0.1/alert.wav' );
    }
  }
  else
  {
    var inQueueDiv = document.getElementById('ajax_popup_notify_div');
    if ( inQueueDiv != null )
    {
      inQueueDiv.style.display = "none";
    }  
  }
}
function chatOp_MonitorLiveChatAction( additionalParam )
{
  postXmlHttp( ajax_livechat_monitor_url+'&opMonitorLiveChat=Y&'+additionalParam, 'chatOp_MonitorLiveChatActionRefresh()' );
}
function chatOp_MonitorLiveChatActionRefresh()
{
  var inQueueDiv = document.getElementById('ajax_popup_notify_div');
  if ( inQueueDiv != null )
  {
    inQueueDiv.style.display = "none";
  }  
}

function gen_display_self_closing_msg( msg )
{
  var gen_ui_helper_div = document.getElementById('gen_ui_helper_div');
  if ( gen_ui_helper_div != null )
  {
    gen_ui_helper_div.innerHTML = '<BR><table width=300 height=80 cellspacing=0 cellpadding=0 border=0 align=center><tr><td bgcolor="lightgray" class="normalSmallBold borderA tsPad6" align=center>'+msg+'</td></tr></table>'; 
    gen_ui_helper_div.style.visibility = 'visible';
    gen_ui_helper_div.style.display = "block";
    gen_ui_helper_div.style.top   = document.body.offsetHeight / 2 + "px";
    gen_ui_helper_div.style.left  = ( document.body.offsetWidth / 2 - 200 ) + "px";
    gen_ui_helper_div.style.width = "300px";
    gen_ui_helper_div.style.width = "80px";
    adjustiFrame( gen_ui_helper_div );
  }
  
  setTimeout( gen_display_self_closing_msg_close, 2000 );
}

function gen_display_self_closing_msg_close()
{
  var gen_ui_helper_div = document.getElementById('gen_ui_helper_div');
  if ( gen_ui_helper_div != null )
  {
    gen_ui_helper_div.style.visibility = 'hidden';
    gen_ui_helper_div.style.display = "none";
    adjustiFrame( gen_ui_helper_div );
  }
}

function $() {
  var elements = new Array();

  for (var i = 0; i < arguments.length; i++) {
    var element = arguments[i];
    if (typeof element == 'string')
      element = document.getElementById(element);

    if (arguments.length == 1)
      return element;

    elements.push(element);
  }

  return elements;
}


var $v = function( divElmtId ) {
  return $(divElmtId)==null?'':$(divElmtId).value;
}


String.prototype.ltrim = function() {
	return this.replace(/^\s\s*/, '');
}
String.prototype.rtrim = function() {
	return this.replace(/\s\s*$/, '');
}
String.prototype.trim = function() {
	return this.ltrim().rtrim();
}


function eb_escape( s )
{
  if ( eb_page_language == 'EV_CZECH' )     return encodeURIComponent( s );
  else if ( eb_page_language == 'UTF_EN' )  return Utf8Url.encode(s) ;
  else if ( eb_page_language == 'CHINESE' ) return GB2312UTF8.GB2312ToUTF8( s );
  else                                      return Utf8Url.encode(s) ; // escape( s );
}
function eb_escape_strong( s )
{
  if ( eb_page_language == 'EV_CZECH' )     return encodeURIComponent( s );
  else if ( eb_page_language == 'UTF_EN' )  return Utf8Url.encode(s) ;
  else if ( eb_page_language == 'CHINESE' ) return GB2312UTF8.GB2312ToUTF8( s );
  else                                      return Utf8Url.encode(s) ; // escape( s );
}
GB2312UTF8  = {
  Dig2Dec : function(s){
      var retV = 0;
      if(s.length == 4){
          for(var i = 0; i < 4; i ++){
              retV += eval(s.charAt(i)) * Math.pow(2, 3 - i);
          }
          return retV;
      }
      return -1;
  } ,

  Hex2Utf8 : function(s){
     var retS = "";
     var tempS = "";
     var ss = "";
     if(s.length == 16){
         tempS = "1110" + s.substring(0, 4);
         tempS += "10" +  s.substring(4, 10);
         tempS += "10" + s.substring(10,16);
         var sss = "0123456789ABCDEF";
         for(var i = 0; i < 3; i ++){
            retS += "%";
            ss = tempS.substring(i * 8, (eval(i)+1)*8);
            retS += sss.charAt(this.Dig2Dec(ss.substring(0,4)));
            retS += sss.charAt(this.Dig2Dec(ss.substring(4,8)));
         }
         return retS;
     }
     return "";
  } ,

  Dec2Dig : function(n1){
      var s = "";
      var n2 = 0;
      for(var i = 0; i < 4; i++){
         n2 = Math.pow(2,3 - i);
         if(n1 >= n2){
            s += '1';
            n1 = n1 - n2;
          }
         else
          s += '0';
      }
      return s;
  },

  Str2Hex : function(s){
      var c = "";
      var n;
      var ss = "0123456789ABCDEF";
      var digS = "";
      for(var i = 0; i < s.length; i ++){
         c = s.charAt(i);
         n = ss.indexOf(c);
         digS += this.Dec2Dig(eval(n));
      }
      return digS;
  },

  GB2312ToUTF8 : function(s1){
    var s = escape(s1);
    var sa = s.split("%");
    var retV ="";
    if(sa[0] != ""){
      retV = sa[0];
    }
    for(var i = 1; i < sa.length; i ++){
      if(sa[i].substring(0,1) == "u"){
        //alert(this.Str2Hex(sa[i].substring(1,5)));
        retV += this.Hex2Utf8(this.Str2Hex(sa[i].substring(1,5)));
  if(sa[i].length){
    retV += sa[i].substring(5);
  }
      }
      else{
     retV += unescape("%" + sa[i]);
  if(sa[i].length){
    retV += sa[i].substring(5);
  }
   }
    }
    return retV;
  },

  UTF8ToGB2312 : function(str1){
        var substr = "";
        var a = "";
        var b = "";
        var c = "";
        var i = -1;
        i = str1.indexOf("%");
        if(i==-1){
          return str1;
        }
        while(i!= -1){
    if(i<3){
                substr = substr + str1.substr(0,i-1);
                str1 = str1.substr(i+1,str1.length-i);
                a = str1.substr(0,2);
                str1 = str1.substr(2,str1.length - 2);
                if(parseInt("0x" + a) & 0x80 == 0){
                  substr = substr + String.fromCharCode(parseInt("0x" + a));
                }
                else if(parseInt("0x" + a) & 0xE0 == 0xC0){ //two byte
                        b = str1.substr(1,2);
                        str1 = str1.substr(3,str1.length - 3);
                        var widechar = (parseInt("0x" + a) & 0x1F) << 6;
                        widechar = widechar | (parseInt("0x" + b) & 0x3F);
                        substr = substr + String.fromCharCode(widechar);
                }
                else{
                        b = str1.substr(1,2);
                        str1 = str1.substr(3,str1.length - 3);
                        c = str1.substr(1,2);
                        str1 = str1.substr(3,str1.length - 3);
                        var widechar = (parseInt("0x" + a) & 0x0F) << 12;
                        widechar = widechar | ((parseInt("0x" + b) & 0x3F) << 6);
                        widechar = widechar | (parseInt("0x" + c) & 0x3F);
                        substr = substr + String.fromCharCode(widechar);
                }
     }
     else {
      substr = substr + str1.substring(0,i);
      str1= str1.substring(i);
     }
              i = str1.indexOf("%");
        }

        return substr+str1;
  }
};

Utf8Url = {
 
  // public method for url encoding
  encode : function (string) {
    return escape(this._utf8_encode(string));
  },
 
  // public method for url decoding
  decode : function (string) {
    return this._utf8_decode(unescape(string));
  },
 
  // private method for UTF-8 encoding
  _utf8_encode : function (string) {
    string = string.replace(/\r\n/g,"\n");
    var utftext = "";
 
    for (var n = 0; n < string.length; n++) {
 
      var c = string.charCodeAt(n);
 
      if (c < 128) {
        utftext += String.fromCharCode(c);
      }
      else if((c > 127) && (c < 2048)) {
        utftext += String.fromCharCode((c >> 6) | 192);
        utftext += String.fromCharCode((c & 63) | 128);
      }
      else {
        utftext += String.fromCharCode((c >> 12) | 224);
        utftext += String.fromCharCode(((c >> 6) & 63) | 128);
        utftext += String.fromCharCode((c & 63) | 128);
      }
 
    }
 
    return utftext;
  },
 
  // private method for UTF-8 decoding
  _utf8_decode : function (utftext) {
    var string = "";
    var i = 0;
    var c = c1 = c2 = 0;
 
    while ( i < utftext.length ) {
 
      c = utftext.charCodeAt(i);
 
      if (c < 128) {
        string += String.fromCharCode(c);
        i++;
      }
      else if((c > 191) && (c < 224)) {
        c2 = utftext.charCodeAt(i+1);
        string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
        i += 2;
      }
      else {
        c2 = utftext.charCodeAt(i+1);
        c3 = utftext.charCodeAt(i+2);
        string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
        i += 3;
      }
 
    }
 
    return string;
  }
}

function advCfOptOnchange( selObj )
{
  postXmlHttp ( 'xhpAdvCfOption.jsp'+genappend_submiturl+'&cfid='+selObj.getAttribute('id')+'&val='+selObj.value, advCfOptOnchangeRefresh );
}
function advCfOptOnchangeRefresh()
{
  var xmlDoc = _xmlHttpRequestObj.responseXML;
  if ( xmlDoc != null && xmlDoc.documentElement != null
         && xmlDoc.documentElement.hasChildNodes() && xmlDoc.firstChild.nodeName != "parsererror" )
  {
    var root = xmlDoc.documentElement;
    if (root != null)
    {
      var items = root.childNodes;
      for (var i=0; i<items.length; i++)
      {
        var cfid = items[i].getAttribute("cfid");
        if ( cfid != null && $('CF_'+cfid) != null )
        {
          for( var seli=$('CF_'+cfid).length-1; seli>=0; seli--)
          {
            $('CF_'+cfid).options[i] = null;
          }
          $('CF_'+cfid).options[0] = new Option( '','' );

          var itm_l2 = items[i].childNodes;
          for (var j=0; j<itm_l2.length; j++)
          {
            $('CF_'+cfid).options[j+1] = new Option( itm_l2[j].getAttribute("cfoval"), itm_l2[j].getAttribute("cfoval") );
          }
        }
      }
    }
  }
}

function advTwoLevelOnchange( selObj )
{
  postXmlHttp ( 'xhpAdvCfOption.jsp'+genappend_submiturl+'&cfid='+selObj.getAttribute('id')+'&val='+selObj.value, advTwoLevelOnchangeRefresh );
}
function advTwoLevelOnchangeRefresh()
{
  var xmlDoc = _xmlHttpRequestObj.responseXML;
  if ( xmlDoc != null && xmlDoc.documentElement != null
         && xmlDoc.documentElement.hasChildNodes() && xmlDoc.firstChild.nodeName != "parsererror" )
  {
    var root = xmlDoc.documentElement;
    if (root != null)
    {
      var items = root.childNodes;
      if ( $('ASSET_TYPE') != null )
      {
          for( var seli=$('ASSET_TYPE').length-1; seli>=0; seli--)
          {
            $('ASSET_TYPE').options[seli] = null;
          }
          $('ASSET_TYPE').options[0] = new Option( '','' );

          var itm_l2 = items[0].childNodes;
          for (var j=0; j<itm_l2.length; j++)
          {
            $('ASSET_TYPE').options[j+1] = new Option( itm_l2[j].getAttribute("dtl_v"), itm_l2[j].getAttribute("dtl_k") );
          }
      }
    }
  }
}

function advOppChannelOnchange( selObj )
{
  postXmlHttp ( 'xhpAdvCfOption.jsp'+genappend_submiturl+'&cfid=NA&ocp=Y&val='+selObj.value, advOppChannelOnchangeRefresh );
}
function advOppChannelOnchangeRefresh()
{
  var xmlDoc = _xmlHttpRequestObj.responseXML;
  if ( xmlDoc != null && xmlDoc.documentElement != null
         && xmlDoc.documentElement.hasChildNodes() && xmlDoc.firstChild.nodeName != "parsererror" )
  {
    var root = xmlDoc.documentElement;
    if (root != null)
    {
      var items = root.childNodes;
      if ( $('CHANNEL_DETAIL') != null )
      {
          for( var seli=$('CHANNEL_DETAIL').length-1; seli>=0; seli--)
          {
            $('CHANNEL_DETAIL').options[seli] = null;
          }
          $('CHANNEL_DETAIL').options[0] = new Option( '','' );

          var itm_l2 = items[0].childNodes;
          for (var j=0; j<itm_l2.length; j++)
          {
            $('CHANNEL_DETAIL').options[j+1] = new Option( itm_l2[j].getAttribute("dtl_v"), itm_l2[j].getAttribute("dtl_k") );
          }
      }
    }
  }
}

function gup( name )
{
  name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+name+"=([^&#]*)";
  var regex = new RegExp( regexS );
  var results = regex.exec( window.location.href );
  if( results == null )
    return "";
  else
    return results[1];
}

/*Bug 2864: Support Module > Knowledge Base > Screen Walk Through kbase article*/
function swk_nav_screen( idx )
{
  $('SWK_DIV_IMG').innerHTML = $('SWK_DIV_IMG_'+idx).innerHTML; ToggleSetExt( 'SWK_DIV_IMG' );
  $('SWK_DIV_TXT').innerHTML = $('SWK_DIV_TXT_'+idx).innerHTML;
  $('SWK_DIV_NAV').innerHTML = $('SWK_DIV_NAV_'+idx).innerHTML;
  $('SWK_DIV_NAV_B').innerHTML = $('SWK_DIV_NAV_'+idx).innerHTML;
}
/*Fine tuning the "Advanced SMB" module - Case 9        :N2G-012         :03Aug2012  */
function openTaskEditPopupV1( taskid, urlAddOn )
{
  if ( urlAddOn == undefined ) urlAddOn = '';
  var popWin = window.open( 'ozCalLOVTaskDtl.jsp?id='+taskid+urlAddOn,'editTaskPopupV1'+taskid,'width=880,height=680,scrollbars=yes,resizable=yes' );
  popWin.opener = self;
  popWin.focus();
}
/*Bug #:3112     All versions > Include Time Sheet in Admin area      :  N2G-012          :10Aug2012*/
function limit2dec00(val)
{
    if (val == 0) return ("0.00");
    if (val == "") return ("");
    var inputVal = ("" + val);
    if (inputVal.indexOf(".") == -1) inputVal+=".000000";
    else                             inputVal+="000000";
    var decPart = inputVal.substring(0,inputVal.indexOf("."));
    var fracPart = inputVal.substring(inputVal.indexOf(".")+1,inputVal.indexOf(".")+3);
    var dec3Part=parseInt(inputVal.substring(inputVal.indexOf(".")+3,inputVal.indexOf(".")+4));
    if ((dec3Part >= 5))
    {
      if(parseFloat(fracPart)== 99)
      {
        fracPart = "00";
        if(parseFloat(decPart)>=0) decPart  =  ""+ (parseFloat(decPart) + 1);
        else decPart  =  ""+ (parseFloat(decPart) - 1);
      }
      else
      {
        var tmp = parseFloat( fracPart ) + 1;
        if ( tmp < 10 )        fracPart = "0"+tmp;
        else                   fracPart = ""+tmp;
      }
    }
    return ("" + decPart + "." + fracPart);
}



function multi_context_orgfg_showRO( fgid, orgid, formname )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&orgid='+orgid+'&act=SHOW_FG_RO&fn='+formname, multi_context_orgfg_refresh, 'POST', fgid );
}
function multi_context_orgfg_showRO_withoutedit( fgid, orgid )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&orgid='+orgid+'&act=SHOW_FG_RO&edit=N', multi_context_orgfg_refresh, 'POST', fgid );
}
function multi_context_orgfg_showED( fgid, orgid, formname )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&orgid='+orgid+'&act=SHOW_FG_ED&fn='+formname, multi_context_orgfg_refresh, 'POST', fgid );
}
function multi_context_orgfg_refresh( in_responseText, in_param )
{
  document.getElementById('DIV_MC_ORGFG_'+in_param).innerHTML = in_responseText;
}


function multi_context_psnfg_showRO( fgid, psnid, formname )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&psnid='+psnid+'&act=SHOW_FG_RO&fn='+formname, multi_context_psnfg_refresh, 'POST', fgid );
}
function multi_context_psnfg_showRO_withoutedit( fgid, psnid )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&psnid='+psnid+'&act=SHOW_FG_RO&edit=N', multi_context_psnfg_refresh, 'POST', fgid );
}
function multi_context_psnfg_showED( fgid, psnid, formname )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&psnid='+psnid+'&act=SHOW_FG_ED&fn='+formname, multi_context_psnfg_refresh, 'POST', fgid );
}

function multi_context_psnfg_showRO( fgid, psnid, formname, pageid )
{
SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&psnid='+psnid+'&act=SHOW_FG_RO&fn='+formname+'&pageid='+pageid, multi_context_psnfg_refresh, 'POST', fgid );
}

function multi_context_psnfg_showED( fgid, psnid, formname, pageid ) /*PPOL-1740*/
{
SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&psnid='+psnid+'&act=SHOW_FG_ED&fn='+formname+'&pageid='+pageid, multi_context_psnfg_refresh, 'POST', fgid );
}
function multi_context_psnfg_refresh( in_responseText, in_param )
{
  document.getElementById('DIV_MC_PSNFG_'+in_param).innerHTML = in_responseText;
}


function multi_context_oppfg_showRO( fgid, oppid, formname )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&oppid='+oppid+'&act=SHOW_FG_RO&fn='+formname, multi_context_oppfg_refresh, 'POST', fgid );
}
function multi_context_oppfg_showRO_withoutedit( fgid, oppid )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&oppid='+oppid+'&act=SHOW_FG_RO&edit=N', multi_context_oppfg_refresh, 'POST', fgid );
}
function multi_context_oppfg_showED( fgid, oppid, formname )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&oppid='+oppid+'&act=SHOW_FG_ED&fn='+formname, multi_context_oppfg_refresh, 'POST', fgid );
}
//PPOL-1429 Field's from FG are not updating correctly from the External page.. N2G 017 Jan 04 2015
function multi_context_oppfg_showRO_withoutedit( fgid, oppid, pageid )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&oppid='+oppid+'&act=SHOW_FG_RO&edit=N&pageid='+pageid, multi_context_oppfg_refresh, 'POST', fgid );
}
function multi_context_oppfg_showRO( fgid, oppid, formname,pageid )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&oppid='+oppid+'&act=SHOW_FG_RO&fn='+formname+'&pageid='+pageid, multi_context_oppfg_refresh, 'POST', fgid );
}
function multi_context_oppfg_showED( fgid, oppid, formname,pageid )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&oppid='+oppid+'&act=SHOW_FG_ED&fn='+formname+'&pageid='+pageid, multi_context_oppfg_refresh, 'POST', fgid );
}//PPOL-1429
function multi_context_oppfg_refresh( in_responseText, in_param )
{
  //$('DIV_MC_OPPFG_'+in_param).innerHTML = in_responseText;
  // context sensitive field group not displaying N2G 017 Aug 28 2015
    document.getElementById('DIV_MC_OPPFG_'+in_param).innerHTML = in_responseText;
}


function multi_context_csefg_showRO( fgid, cseid, formname )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&cseid='+cseid+'&act=SHOW_FG_RO&fn='+formname, multi_context_csefg_refresh, 'POST', fgid );
}
function multi_context_csefg_showRO_withoutedit( fgid, cseid )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&cseid='+cseid+'&act=SHOW_FG_RO&edit=N', multi_context_csefg_refresh, 'POST', fgid );
}
function multi_context_csefg_showED( fgid, cseid, formname )
{
  SimpleAJAXCall ( 'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&fgid='+fgid+'&cseid='+cseid+'&act=SHOW_FG_ED&fn='+formname, multi_context_csefg_refresh, 'POST', fgid );
}
function multi_context_csefg_refresh( in_responseText, in_param )
{
  //$('DIV_MC_CSEFG_'+in_param).innerHTML = in_responseText;
  // context sensitive field group not displaying N2G 017 Aug 28 2015  
    document.getElementById('DIV_MC_CSEFG_'+in_param).innerHTML = in_responseText;
}


function multi_context_orgfg_save( fgid, orgid, formnameid )
{
    Ext.Ajax.timeout = 300000;  
    Ext.Ajax.request({
      url:  'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&act=SUBMIT_FG&fgid='+fgid+'&orgid='+orgid+'&fn='+formnameid,
      form: formnameid,
      success: function(response, opts) {
        if ( response.responseText.indexOf("Failed:") >= 0 )
        {
          alert( 'failure with the following text ' + ALLTrim(response.responseText) );
        }
        else
        {
          try { multi_context_orgfg_showRO( fgid, orgid, formnameid ) } catch (exception) {}
        }
      },
      failure: function(response, opts) {
        alert( 'failure with status code ' + response.status );
      }
    });
}
function multi_context_psnfg_save( fgid, psnid, formnameid )
{
    Ext.Ajax.timeout = 300000;  
    Ext.Ajax.request({
      url:  'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&act=SUBMIT_FG&fgid='+fgid+'&psnid='+psnid+'&fn='+formnameid,
      form: formnameid,
      success: function(response, opts) {
        if ( response.responseText.indexOf("Failed:") >= 0 )
        {
          alert( 'failure with the following text ' + ALLTrim(response.responseText) );
        }
        else
        {
          try { multi_context_psnfg_showRO( fgid, psnid, formnameid ) } catch (exception) {}
        }
      },
      failure: function(response, opts) {
        alert( 'failure with status code ' + response.status );
      }
    });
}
function multi_context_oppfg_save( fgid, oppid, formnameid )
{
    Ext.Ajax.timeout = 300000;  
    Ext.Ajax.request({
      url:  'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&act=SUBMIT_FG&fgid='+fgid+'&oppid='+oppid+'&fn='+formnameid,
      form: formnameid,
      success: function(response, opts) {
        // _JQ.unblockUI();
        
        if ( response.responseText.indexOf("Failed:") >= 0 )
        {
          alert( 'failure with the following text ' + ALLTrim(response.responseText) );
          // jAlert( jQuery.trim(response.responseText), 'Failed to save opportunity field values' );
        }
        else
        {
          try { multi_context_oppfg_showRO( fgid, oppid, formnameid ) } catch (exception) {}
        }
      },
      failure: function(response, opts) {
        // _JQ.unblockUI();
        //Bug:4214  Save button non-functional under Opportunities - Process - Custom Field Group  
        //alert( 'failure with status code ' + response.status );
      }
    });
}
function multi_context_csefg_save( fgid, cseid, formnameid )
{
    Ext.Ajax.timeout = 300000;  
    Ext.Ajax.request({
      url:  'xhpCmnFieldGroup.jsp'+genappend_submiturl+'&act=SUBMIT_FG&fgid='+fgid+'&cseid='+cseid+'&fn='+formnameid,
      form: formnameid,
      success: function(response, opts) {
        if ( response.responseText.indexOf("Failed:") >= 0 )
        {
          alert( 'failure with the following text ' + ALLTrim(response.responseText) );
        }
        else
        {
          try { multi_context_csefg_showRO( fgid, cseid, formnameid ) } catch (exception) {}
        }
      },
      failure: function(response, opts) {
        alert( 'failure with status code ' + response.status );
      }
    });
}

function multi_context_psnfg_validate( fgid, psnid, formnameid )
{
    Ext.Ajax.timeout = 300000;
    Ext.Ajax.request({
      url:  'xhpCmnFieldGroupValidate.jsp'+genappend_submiturl+'&act=PSN&fgid='+fgid+'&psnid='+psnid+'&fn='+formnameid,
      form: formnameid,
      success: function(response, opts) {

        if ( response.responseText.indexOf("Failed:") >= 0 )
        {
          alert( 'failure with the following text ' + ALLTrim(response.responseText) );
        }
        else
        {
          var text = response.responseText.trim();
          if (text == '')
          {
             try { multi_context_psnfg_save( fgid, psnid, formnameid); } catch (exception) {}
          }
          else
          {
            alert(text);
          }
        }
      },
      failure: function(response, opts) {

      }
    });
}
function multi_context_orgfg_validate( fgid, orgid, formnameid )
{
    Ext.Ajax.timeout = 300000;
    Ext.Ajax.request({
      url:  'xhpCmnFieldGroupValidate.jsp'+genappend_submiturl+'&act=ORG&fgid='+fgid+'&orgid='+orgid+'&fn='+formnameid,
      form: formnameid,
      success: function(response, opts) {

        if ( response.responseText.indexOf("Failed:") >= 0 )
        {
          alert( 'failure with the following text ' + ALLTrim(response.responseText) );
        }
        else
        {
          var text = response.responseText.trim();
          if (text == '')
          {
             try { multi_context_orgfg_save( fgid, orgid, formnameid); } catch (exception) {}
          }
          else
          {
            alert(text);
          }
        }
      },
      failure: function(response, opts) {

      }
    });
}
function multi_context_oppfg_validate( fgid, oppid, formnameid )
{
    Ext.Ajax.timeout = 300000;
    Ext.Ajax.request({
      url:  'xhpCmnFieldGroupValidate.jsp'+genappend_submiturl+'&act=OPP&fgid='+fgid+'&oppid='+oppid+'&fn='+formnameid,
      form: formnameid,
      success: function(response, opts) {

        if ( response.responseText.indexOf("Failed:") >= 0 )
        {
          alert( 'failure with the following text ' + ALLTrim(response.responseText) );
        }
        else
        {
          var text = response.responseText.trim();
          if (text == '')
          {
             try { multi_context_oppfg_save( fgid, oppid, formnameid); } catch (exception) {}
          }
          else
          {
            alert(text);
          }
        }
      },
      failure: function(response, opts) {

      }
    });
}
function multi_context_csefg_validate( fgid, cseid, formnameid )
{
    Ext.Ajax.timeout = 300000;
    Ext.Ajax.request({
      url:  'xhpCmnFieldGroupValidate.jsp'+genappend_submiturl+'&act=CSE&fgid='+fgid+'&cseid='+cseid+'&fn='+formnameid,
      form: formnameid,
      success: function(response, opts) {

        if ( response.responseText.indexOf("Failed:") >= 0 )
        {
          alert( 'failure with the following text ' + ALLTrim(response.responseText) );
        }
        else
        {
          var text = response.responseText.trim();
          if (text == '')
          {
             try { multi_context_csefg_save( fgid, cseid, formnameid); } catch (exception) {}
          }
          else
          {
            alert(text);
          }
        }
      },
      failure: function(response, opts) {

      }
    });
}
   // PPOL-282  Case 90252638 process builder in snapshot
var _gOppSnapshotProcBuilderOppId   = 0;
var _gOppSnapshotProcBuilderStepId  = 0;
function OppSnapshotProcBuilder_selectTab( tabId )
{
  console.log(tabId);
  SimpleAJAXCall( 'xhpOppSnapshotProcBuilder.jsp'+genappend_submiturl+'&type=OPP_PROCESS_CONFIRM&oppid='+_gOppSnapshotProcBuilderOppId+'&txpsid='+_gOppSnapshotProcBuilderStepId+'&tabid='+tabId, OppSnapshotProcBuilder_show_refresh, 'POST', '' );
}
function OppSnapshotProcBuilder_show_refresh( in_responseText, in_param )
{
    // console.log("-----"+_gOppSnapshotProcBuilderOppId+"-----");
    // console.log(jQuery.trim(in_responseText));
   document.getElementById('OppSnapshotProcBuilder_'+_gOppSnapshotProcBuilderOppId).innerHTML = jQuery.trim(in_responseText);
    $('#OppSnapshotProcBuilder_'+_gOppSnapshotProcBuilderOppId).show('fast');
}

function  OppSnapshotProcBuilder_SubmitForm()
{
     var   taskname = $('#ahsFormAction').val();
     var   taskid = $('#oppid').val();
    var com = $('textarea#comment_note').val();
      console.log(taskid +"com= "+ com);
        $(document).ready(function(){
    $.ajax({
        url: 'xhpOppSnapshotProcBuilder.jsp'+genappend_submiturl,
        type: "post",
        form: 'form_OppSnapshotProcBuilder',
        data: {ahsFormAction: taskname,oppid:taskid ,comment_note:com},
        dataType:"json",
        success: function(data){
              if(data == 'true')
              {
                 console.log('True block');
              }
            else
              {
                  console.log("false block");
                  OppSnapshotProcBuilder_redraw();
              }
        },
        error: function(){
            console.log("error");
           OppSnapshotProcBuilder_redraw();
        }
    })
})
}
function  OppSnapshotProcBuilder_SubmitForm1()
{
     var   taskname = $('#ahsFormAction').val();
     var str=taskname.substring(14);
     var   taskid = $('#oppid').val();
   var comment = $(this).attr('id').replace('comment_', $('textarea#comment_'+str).val());
   var com = $('textarea#comment_'+str).val();
    var due = $('input#dueDate_'+str).val();
    var assingTo = $('#assignTo_'+str+' option:selected ').val();
     // console.log("taskid="+taskid +"com= "+ com +" str ="+str+"due ="+due+"AssignTo="+assingTo);
      //console.log("Data ="+$('textarea#comment_'+str).text());
        $(document).ready(function(){
         $.ajax({
        url: 'xhpOppSnapshotProcBuilder.jsp'+genappend_submiturl,
        type: "POST",
        form: 'form_OppSnapshotProcBuilder',
        data:  {ahsFormAction:taskname , oppid :taskid ,comment_:com , dueDate_ : due , assignTo_: assingTo },
        contentType: "application/x-www-form-urlencoded",
        dataType:"html",
         success: function(data){
              if(data == 'true')
              {
                 console.log('True block');
              }
            else
              {
                  console.log("false block");
                  OppSnapshotProcBuilder_redraw();
              }
        },
        error: function(){
            console.log("error");
           // OppSnapshotProcBuilder_redraw();
        }
       
     });
            
});

}

function OppSnapshotProcBuilder_redraw()
{
  console.log('OppSnapshotProcBuilder_redraw');
  SimpleAJAXCall( 'xhpOppSnapshotProcBuilder.jsp'+genappend_submiturl+'&type=REDRAW&oppid='+_gOppSnapshotProcBuilderOppId, OppSnapshotProcBuilder_redraw_refresh, 'POST', '' );
}
function OppSnapshotProcBuilder_redraw_refresh( in_responseText, in_param )
{
    //console.log("OppSnapshotProcBuilder_redraw_refresh( in_responseText, in_param )"+_gOppSnapshotProcBuilderOppId+" "+in_responseText);
     $('#OppSnapshotProcBuilder_'+_gOppSnapshotProcBuilderOppId).hide(2000);
} // PPOL-282



//PPOL-1377
function nonEditable(id)
{
    document.getElementById("Read_Only_"+id).innerHTML="Read Only Field";
}
//PPOL-1377
function nonEditableHide1(id)
{
    document.getElementById("Read_Only_"+id).innerHTML=" ";
}
